
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Moneywall API | Документация</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Поиск">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#v1" class="toc-h1 toc-link" data-title=" API v1 "> API v1 </a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#introduction" class="toc-h2 toc-link" data-title="Общая информация">Общая информация</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#formula" class="toc-h3 toc-link" data-title="Формула расчета цены">Формула расчета цены</a>
                            </li>
                        </ul>
                  </li>
                  <li>
                    <a href="#auth" class="toc-h2 toc-link" data-title="Аутентификация">Аутентификация</a>
                  </li>
                  <li>
                    <a href="#payments" class="toc-h2 toc-link" data-title="Платежные сессии">Платежные сессии</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#payment-init" class="toc-h3 toc-link" data-title="Начало платежной сессии">Начало платежной сессии</a>
                            </li>
                            <li>
                              <a href="#product-add" class="toc-h3 toc-link" data-title="Добавление выписанных билетов к заказу">Добавление выписанных билетов к заказу</a>
                            </li>
                            <li>
                              <a href="#payment-state" class="toc-h3 toc-link" data-title="Статус платёжной сессии">Статус платёжной сессии</a>
                            </li>
                            <li>
                              <a href="#payment-states-array" class="toc-h3 toc-link" data-title="Список статусов платёжных сессий за период">Список статусов платёжных сессий за период</a>
                            </li>
                            <li>
                              <a href="#payment-refund" class="toc-h3 toc-link" data-title="Возврат">Возврат</a>
                            </li>
                        </ul>
                  </li>
                  <li>
                    <a href="#entity-schemes" class="toc-h2 toc-link" data-title="Объекты и сущности">Объекты и сущности</a>
                  </li>
                  <li>
                    <a href="#payment-cards" class="toc-h2 toc-link" data-title="Тестовые карты">Тестовые карты</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#v1-eng" class="toc-h1 toc-link" data-title=" [ENG] API v1 "> [ENG] API v1 </a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#introduction-eng" class="toc-h2 toc-link" data-title="General Information">General Information</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#calc-eng" class="toc-h3 toc-link" data-title="Price Calculation Formula">Price Calculation Formula</a>
                            </li>
                        </ul>
                  </li>
                  <li>
                    <a href="#auth-eng" class="toc-h2 toc-link" data-title="Authentification">Authentification</a>
                  </li>
                  <li>
                    <a href="#payments-eng" class="toc-h2 toc-link" data-title="Payment Sessions">Payment Sessions</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#payments-init-eng" class="toc-h3 toc-link" data-title="Start of a Payment Session">Start of a Payment Session</a>
                            </li>
                            <li>
                              <a href="#product-add-eng" class="toc-h3 toc-link" data-title="Adding issued tickets to the order">Adding issued tickets to the order</a>
                            </li>
                            <li>
                              <a href="#payments-state-eng" class="toc-h3 toc-link" data-title="Payment Session Status">Payment Session Status</a>
                            </li>
                            <li>
                              <a href="#payments-states-array-eng" class="toc-h3 toc-link" data-title="List of payment sessions statuses for a period">List of payment sessions statuses for a period</a>
                            </li>
                            <li>
                              <a href="#payment-refund-eng" class="toc-h3 toc-link" data-title="Refund">Refund</a>
                            </li>
                        </ul>
                  </li>
                  <li>
                    <a href="#entity-schemas-eng" class="toc-h2 toc-link" data-title="Objects and Entities">Objects and Entities</a>
                  </li>
                  <li>
                    <a href="#payment-cards-eng" class="toc-h2 toc-link" data-title="Test cards">Test cards</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#v2" class="toc-h1 toc-link" data-title=" API v2 "> API v2 </a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#entities-v2" class="toc-h2 toc-link" data-title="Системные сущности">Системные сущности</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#credit-application-entity-v2" class="toc-h3 toc-link" data-title=" Кредитная заявка "> Кредитная заявка </a>
                            </li>
                            <li>
                              <a href="#credit-agreement-entity-v2" class="toc-h3 toc-link" data-title=" Кредитный договор "> Кредитный договор </a>
                            </li>
                            <li>
                              <a href="#credit-signature-entity-v2" class="toc-h3 toc-link" data-title=" Электронная подпись "> Электронная подпись </a>
                            </li>
                            <li>
                              <a href="#local-passport-entity-v2" class="toc-h3 toc-link" data-title=" Общегражданский паспорт "> Общегражданский паспорт </a>
                            </li>
                            <li>
                              <a href="#address-entity-v2" class="toc-h3 toc-link" data-title=" Адрес регистрации "> Адрес регистрации </a>
                            </li>
                            <li>
                              <a href="#international-passport-entity-v2" class="toc-h3 toc-link" data-title=" Заграничный паспорт "> Заграничный паспорт </a>
                            </li>
                            <li>
                              <a href="#document-photo-entity-v2" class="toc-h3 toc-link" data-title=" Фотография документа "> Фотография документа </a>
                            </li>
                            <li>
                              <a href="#social-profile-entity-v2" class="toc-h3 toc-link" data-title=" Профиль социальной сети "> Профиль социальной сети </a>
                            </li>
                            <li>
                              <a href="#initial-payment-entity-v2" class="toc-h3 toc-link" data-title=" Первоначальный платеж "> Первоначальный платеж </a>
                            </li>
                            <li>
                              <a href="#credit-card-entity-v2" class="toc-h3 toc-link" data-title=" Банковская карта "> Банковская карта </a>
                            </li>
                            <li>
                              <a href="#decision-entity-v2" class="toc-h3 toc-link" data-title=" Решение по заявке "> Решение по заявке </a>
                            </li>
                            <li>
                              <a href="#scheduled-payment-entity-v2" class="toc-h3 toc-link" data-title=" Очередной платеж "> Очередной платеж </a>
                            </li>
                            <li>
                              <a href="#payment-attempt-entity-v2" class="toc-h3 toc-link" data-title=" Попытка списания "> Попытка списания </a>
                            </li>
                            <li>
                              <a href="#charged-payment-entity-v2" class="toc-h3 toc-link" data-title=" Состоявшийся платеж "> Состоявшийся платеж </a>
                            </li>
                            <li>
                              <a href="#refund-entity-v2" class="toc-h3 toc-link" data-title=" Возврат "> Возврат </a>
                            </li>
                            <li>
                              <a href="#product-entity-v2" class="toc-h3 toc-link" data-title=" Товар "> Товар </a>
                            </li>
                            <li>
                              <a href="#additional-entities-v2" class="toc-h3 toc-link" data-title="Дополнительные сущности">Дополнительные сущности</a>
                            </li>
                        </ul>
                  </li>
                  <li>
                    <a href="#auth-v2" class="toc-h2 toc-link" data-title=" Аутентификация "> Аутентификация </a>
                  </li>
                  <li>
                    <a href="#credit-application-v2" class="toc-h2 toc-link" data-title=" Кредитная заявка "> Кредитная заявка </a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#credit-application-v2-signature" class="toc-h3 toc-link" data-title=" Электронная подпись "> Электронная подпись </a>
                            </li>
                            <li>
                              <a href="#9b19ad0c85" class="toc-h3 toc-link" data-title="Документы">Документы</a>
                            </li>
                            <li>
                              <a href="#2b8df6d4ef" class="toc-h3 toc-link" data-title="Фотографии документов">Фотографии документов</a>
                            </li>
                            <li>
                              <a href="#5e513ad59a" class="toc-h3 toc-link" data-title="Соцсети">Соцсети</a>
                            </li>
                            <li>
                              <a href="#348a6d9ca8" class="toc-h3 toc-link" data-title="Первоначальный платеж">Первоначальный платеж</a>
                            </li>
                            <li>
                              <a href="#d0a65eea32" class="toc-h3 toc-link" data-title="Банковская карта">Банковская карта</a>
                            </li>
                            <li>
                              <a href="#b13291dd35" class="toc-h3 toc-link" data-title="Решение по заявке">Решение по заявке</a>
                            </li>
                            <li>
                              <a href="#28191fe3ec" class="toc-h3 toc-link" data-title="Степень заполненности заявки">Степень заполненности заявки</a>
                            </li>
                        </ul>
                  </li>
                  <li>
                    <a href="#credit-agreement-v2" class="toc-h2 toc-link" data-title=" Договор "> Договор </a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#7df0bc4c57" class="toc-h3 toc-link" data-title="График платежей">График платежей</a>
                            </li>
                            <li>
                              <a href="#d44e3a7b8a" class="toc-h3 toc-link" data-title="Очередной платеж">Очередной платеж</a>
                            </li>
                            <li>
                              <a href="#573deecfc8" class="toc-h3 toc-link" data-title="Попытка списания">Попытка списания</a>
                            </li>
                            <li>
                              <a href="#cecde846db" class="toc-h3 toc-link" data-title="Состоявшийся платеж">Состоявшийся платеж</a>
                            </li>
                            <li>
                              <a href="#74a7af0529" class="toc-h3 toc-link" data-title="Возвраты">Возвраты</a>
                            </li>
                            <li>
                              <a href="#d0a65eea32-2" class="toc-h3 toc-link" data-title="Банковская карта">Банковская карта</a>
                            </li>
                            <li>
                              <a href="#d640e3383d" class="toc-h3 toc-link" data-title="Ввод договора в действие (?)">Ввод договора в действие (?)</a>
                            </li>
                        </ul>
                  </li>
                  <li>
                    <a href="#cash-flow-v2" class="toc-h2 toc-link" data-title=" Движения Денежных Средств "> Движения Денежных Средств </a>
                  </li>
                  <li>
                    <a href="#webhooks" class="toc-h2 toc-link" data-title="Webhooks">Webhooks</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#397cc59b74" class="toc-h3 toc-link" data-title="Принятие решения по заявке">Принятие решения по заявке</a>
                            </li>
                            <li>
                              <a href="#aaef60cd3f" class="toc-h3 toc-link" data-title="Изменение графика платежей">Изменение графика платежей</a>
                            </li>
                        </ul>
                  </li>
              </ul>
          </li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='v1'> API v1 </h1>

<h2 id='introduction'>Общая информация</h2>

<p>Moneywall – сервис онлайн-кредитования, который встраивается на страницы оплаты партнеров и позволяет покупателям приобретать товары в кредит.</p>

<p>API работает по протоколу HTTPS, все данные представлены в формате JSON.</p>

<p>Базовый URL – <code>https://dev.moneywall.io/api/partners</code></p>

<p>Простой сценарий подачи и прохождения кредитной заявки:</p>

<ol>
<li>Вызов метода <a href="#payment-init">Начала платежной сессии</a></li>
<li>Вывод фрейма по ссылке, полученной из результата запроса</li>
<li>Ввод пользователем информации</li>
<li>Перенаправление пользователя на <code>redirect_url</code> либо из <code>failure_redirect_url</code></li>
<li>Ожидание решения по заявке</li>
<li>Вызов <code>success_callback_url</code> или <code>failure_callback_url</code> при одобрении или отклонении заявки соответственно</li>
</ol>

<h3 id='formula'>Формула расчета цены</h3>

<p>Для расчёта и отображения платежей и полной стоимости заказа на стороне партнёра, следует использовать упрощенную формулу:</p>

<p><code>ПЛАТЕЖ  = (СУММА ЗАКАЗА * K) / 3,</code></p>

<p>где <code>K = 1.10</code> для случаев, когда вылет наступает после окончания договора займа (позднее 60 дней от даты подачи заявки),
<br>и <code>K = 1.21</code> для случаев, когда вылет наступает ранее даты окончания договора займа.</p>

<h2 id='auth'>Аутентификация</h2>

<p>Аутентификация производится через токен партнера, передаваемый в заголовке Authorization при каждом запросе:</p>

<p><code>Authorization: SuperSecretTokenValue</code></p>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/init"</span>
  -H <span class="s2">"Authorization: SuperSecretTokenValue"</span>
</code></pre>
<aside class="notice">
Пожалуйста, замените <code>SuperSecretTokenValue</code> на предоставленный вам токен
</aside>

<h2 id='payments'>Платежные сессии</h2>

<h3 id='payment-init'>Начало платежной сессии</h3>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/init"</span>
  -X POST
  -H <span class="s2">"Content-Type: application/json"</span>
  -H <span class="s2">"Authorization: SuperSecretTokenValue"</span>
  -d <span class="s1">'{ "phone": "79031232299", "email": "test@test.com", "amount": 10000, "calculated_credit_cost": 12000, "success_callback_url": "http://yoursite.com/callbacks/success", "failure_callback_url": "http://yoursite.com/callbacks/failure", "redirect_url": "http://yoursite.com/order/234", "failure_redirect_url": "http://yoursite.com/order/234/failure", "order_id": "partner_order_id", "web_mode": "standalone", "original_provider_order_id": "original_provider_order_id", "expires_at": "2017-07-01T00:00:00", "product_type": "airline_tickets" }'</span>

</code></pre>
<blockquote>
<p>Команда выше вернет ответ в JSON следующего вида:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span><span class="w">
  </span><span class="s2">"frame_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://dev.moneywall.io/frame/credit_applications/10/payment_graph"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Метод предназначен для начала сессии выдачи кредита</p>

<p><strong>HTTP Запрос</strong></p>

<p><code>POST https://dev.moneywall.io/api/partners/payments/init</code></p>

<p><strong>Схема запроса</strong></p>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>phone</td>
<td>String</td>
<td>&quot;79588249424&quot;</td>
<td>Номер телефона клиента</td>
<td>Да</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>&quot;user@gmail.com&quot;</td>
<td>Адрес электронной почты клиента</td>
<td>Да</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>10000</td>
<td>Сумма заказа клиента на сайте партнера в рублях</td>
<td>Да</td>
</tr>
<tr>
<td>success_callback_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/callbacks/success&quot;</td>
<td>Адрес callback-страницы, вызываемой при одобрении заявки</td>
<td>Да</td>
</tr>
<tr>
<td>failure_callback_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/callbacks/failure&quot;</td>
<td>Адрес callback-страницы, вызываемой при отклонении заявки</td>
<td>Да</td>
</tr>
<tr>
<td>redirect_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/order/AB123-45&quot;</td>
<td>Адрес страницы заказа в системе партнера</td>
<td>Да</td>
</tr>
<tr>
<td>failure_redirect_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/order/AB123-45/failed&quot;</td>
<td>Страница для перенаправления в случае неуспеха</td>
<td>Нет</td>
</tr>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Идентификатор сессии со стороны партнера (по нему можно будет <a href="#payment-state">получать статус</a>)</td>
<td>Да</td>
</tr>
<tr>
<td>web_mode</td>
<td>String: &quot;standalone&quot;, &quot;iframe&quot;</td>
<td>&quot;standalone&quot;</td>
<td>Режим, в котором будет открыт диалог заполнения кредитной заявки (по умолчанию: standalone)</td>
<td>Нет</td>
</tr>
<tr>
<td>original_provider_order_id</td>
<td>String</td>
<td>&quot;AB123-45&quot;</td>
<td>Идентификатор заказа в системе партнера</td>
<td>Нет</td>
</tr>
<tr>
<td>expires_at</td>
<td>DateTime</td>
<td>&quot;2017-07-01T15:00:00+03:00&quot;</td>
<td>Таймлимит для заказа</td>
<td>Нет</td>
</tr>
<tr>
<td>product_type</td>
<td>String</td>
<td>&quot;airline_tickets&quot;/&quot;railway_tickets&quot;/&quot;accommodation&quot;</td>
<td>Тип товара из заказа</td>
<td>Да</td>
</tr>
<tr>
<td>product</td>
<td>Object</td>
<td>См. <a href="#product-schema">схему объекта product</a></td>
<td>Детали товара из заказа</td>
<td>Да</td>
</tr>
<tr>
<td>local_passport</td>
<td>Object</td>
<td>См. <a href="#local-passport-schema">схему объекта local_passport</a></td>
<td>Общегражданский паспорт клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>address</td>
<td>Object</td>
<td>См. <a href="#address-schema">схему объекта address</a></td>
<td>Адрес регистрации клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>international_passport</td>
<td>Object</td>
<td>См. <a href="#international-passport-schema">схему объекта international_passport</a></td>
<td>Загранпаспорт клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>meta</td>
<td>Object</td>
<td>См. <a href="#meta-schema">схему объекта meta</a></td>
<td>Дополнительная информация</td>
<td>Нет</td>
</tr>
</tbody></table>

<blockquote>
<p>Пожалуйста, обратите внимание, что параметры с типом DateTime следует передавать в формате ISO8601 с часовым поясом. Рекомендуемый формат даты: <code>&quot;%Y-%m-%dT%H:%M:%S%:z&quot;</code></p>
</blockquote>

<h3 id='product-add'>Добавление выписанных билетов к заказу</a></h3>
<pre class="highlight shell tab-shell"><code>curl -X POST   <span class="se">\</span>
 -H <span class="s1">'Authorization: SuperSecretTokenValue'</span> <span class="se">\</span>
 -F <span class="s1">'order_id=partner_order_id'</span> <span class="se">\</span>
 -F <span class="s1">'product[product_type]=airline_tickets'</span> <span class="se">\</span>
 -F <span class="s1">'product[product_items][][ticket_number]=123'</span> <span class="se">\</span>
 -F <span class="s1">'product[product_items][][ticket_receipt]=@path/to/file/test_pdf.pdf'</span> <span class="se">\</span>
https://dev.moneywall.io/api/partners/payments/product
</code></pre>
<p>Метод предназначен для сохранения номеров билетов и файлов маршрутных квитанций в кредитной заявке
<strong>HTTP Запрос</strong></p>

<p><code>POST https://dev.moneywall.io/api/partners/payments/product</code></p>

<p><strong>URL параметры</strong></p>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Идентификатор платежной сессии, переданный в метод начала платежной сессии</td>
<td>Да</td>
</tr>
<tr>
<td>transaction_letter</td>
<td>File</td>
<td>@path/to/file/test_pdf.pdf</td>
<td>Транзакционное письмо</td>
<td>Нет</td>
</tr>
<tr>
<td>product</td>
<td>Object</td>
<td>См. <a href="#product">схему объекта product</a></td>
<td>Фактически выписанные билеты</td>
<td>Да</td>
</tr>
</tbody></table>

<h3 id='payment-state'>Статус платёжной сессии</a></h3>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/state?order_id=partner_order_id"</span>
  -H <span class="s2">"Authorization: SuperSecretTokenValue"</span>
</code></pre>
<blockquote>
<p>Команда выше вернет ответ в JSON следующего вида:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"order_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"partner_order_id"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"processing"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Метод предназначен для получения статуса платежной сессии</p>

<aside class="notice">Метод возвращает статус кредитной заявки в системе Moneywall</aside>

<p><strong>HTTP Запрос</strong></p>

<p><code>GET https://dev.moneywall.io/api/partners/payments/state</code></p>

<p><strong>URL параметры</strong></p>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Идентификатор платежной сессии, переданный в метод начала платежной сессии</td>
<td>Да</td>
</tr>
</tbody></table>

<p><strong>Возможные статусы</strong></p>

<p>Описание логики отмены и закрытия договора при возвратах см. в <a href="#payment-refund">разделе Возврат</a></p>

<table><thead>
<tr>
<th>Код&nbsp;статуса</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>processing</td>
<td>Платеж обрабатывается</td>
</tr>
<tr>
<td>cancelled</td>
<td>Платежная сессия отменена</td>
</tr>
<tr>
<td>authorized</td>
<td>Первоначальный платеж оплачен, кредитный договор открыт</td>
</tr>
<tr>
<td>voided</td>
<td>Деньги за первоначальный платеж возвращены клиенту, кредитный договор отменен</td>
</tr>
<tr>
<td>refunded</td>
<td>Произведен полный возврат по кредитному договору</td>
</tr>
<tr>
<td>charged</td>
<td>Денежные средства за первоначальный платеж списаны, возврат по договору возможен только через досрочное погашение и закрытие договора</td>
</tr>
</tbody></table>

<h3 id='payment-states-array'>Список статусов платёжных сессий за период</a></h3>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/states?from=2019-01-01T23:35:14+0300&amp;till=2019-01-13T00:02:13+0300"</span>
  -H <span class="s2">"Authorization: token"</span>
</code></pre>
<blockquote>
<p>Команда выше вернет ответ в JSON следующего вида:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"partner_order_id_1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"processing"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"partner_order_id_2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"cancelled"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p>Метод предназначен для получения статусов платёжных сессий за период</p>

<aside class="notice">Метод возвращает статусы кредитных заявки в системе Moneywall за период</aside>

<p><strong>HTTP Запрос</strong></p>

<p><code>GET https://dev.moneywall.io/api/partners/payments/states</code></p>

<p><strong>URL параметры</strong></p>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>from</td>
<td>DateTime</td>
<td>&quot;2019-01-01T23:35:14+0300&quot;</td>
<td>Время начала периода</td>
<td>Да</td>
</tr>
<tr>
<td>till</td>
<td>DateTime</td>
<td>&quot;2019-01-13T00:02:13+0300&quot;</td>
<td>Время окончания периода</td>
<td>Да</td>
</tr>
</tbody></table>

<h3 id='payment-refund'>Возврат</h3>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/refund"</span>
  -X POST
  -H <span class="s2">"Content-Type: application/json"</span>
  -H <span class="s2">"Authorization: SuperSecretTokenValue"</span>
  -d <span class="s1">'{ "amount": 100, "order_id": "partner_order_id" }'</span>

</code></pre>
<blockquote>
<p>Команда выше вернет следущий ответ:</p>
</blockquote>
<pre class="highlight plaintext"><code>HTTP статус `200`, в случае если запрос обработан. Любой другой статус говорит о том, что запрос обработан не был.
</code></pre>
<p>Метод предназначен для проведение частичного или полного возврата средств по заказу</p>

<p>Частичные возвраты влекут за собой учет средств в пользу задолженности по договору.
Полные возвраты влекут за собой закрытие кредитного договора.</p>

<p><strong>Логика переходов между статусами договора</strong></p>

<p>Договор считается окончательно открытым и подтвержденным через 24 часа после момента его первоначального открытия.<br/>
До 24 часов с момента первоначального открытия договора, его можно отменить.</p>

<p>Соответственно:</p>

<ul>
<li>При полном возврате денежных средств по договору в течение 24 часов после открытия договора, происходит отмена договора и возврат денег на карту клиента путем войдирования платежной сессии;</li>
<li>При полном возврате денежных средств по договору позднее 24 часов после открытия договора, оплата идет в счет погашения.</li>
</ul>

<p><strong>HTTP Запрос</strong></p>

<p><code>POST https://dev.moneywall.io/api/partners/payments/refund</code></p>

<p><strong>URL параметры</strong></p>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Идентификатор платежной сессии, переданный в метод <a href="#payment-init">начала платежной сессии</a></td>
<td>Да</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>100</td>
<td>Сумма возврата в рублях</td>
<td>Да</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>&quot;RUB&quot;</td>
<td>Код валюты в формате ISO-4217</td>
<td>Нет</td>
</tr>
<tr>
<td>document_numbers</td>
<td>Array[String]</td>
<td>[&quot;987654321&quot;, &quot;678912345&quot;]</td>
<td>Номера выпущенных документов на билеты/услуги, по которым запрашивается возврат в рамках заказа</td>
<td>Нет</td>
</tr>
</tbody></table>

<h2 id='entity-schemes'>Объекты и сущности</h2>

<h4 id='product-schema-airline'>Объект <code>product</code> при <code>product_type == 'airline_tickets'</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>cabin_type</td>
<td>String</td>
<td>&quot;economy&quot; (&quot;business&quot;, &quot;premium&quot;)</td>
<td>Класс обслуживания</td>
<td>Нет</td>
</tr>
<tr>
<td>validating_airline</td>
<td>String</td>
<td>&quot;SU&quot;</td>
<td>Валидирующая авиакомпания</td>
<td>Да</td>
</tr>
<tr>
<td>segments</td>
<td>Array</td>
<td>См. <a href="#segment-schema-airline">схему объекта segment</a></td>
<td>Сегменты</td>
<td>Да</td>
</tr>
<tr>
<td>passengers</td>
<td>Array</td>
<td>См. <a href="#passenger">схему объекта passenger</a></td>
<td>Пассажиры</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='product-schema-railway'>Объект <code>product</code> при <code>product_type == 'railway_tickets'</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>segments</td>
<td>Array</td>
<td>См. <a href="#segment-schema-railway">схему объекта segment</a></td>
<td>Сегменты</td>
<td>Да</td>
</tr>
<tr>
<td>passengers</td>
<td>Array</td>
<td>См. <a href="#passenger">схему объекта passenger</a></td>
<td>Пассажиры</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='product-schema-accommodation'>Объект <code>product</code> при <code>product_type == 'accommodation'</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>accommodations</td>
<td>Array</td>
<td>См. <a href="#accommodation-schema">схему объекта accommodation</a></td>
<td>Варианты размещения</td>
<td>Да</td>
</tr>
<tr>
<td>guests</td>
<td>Array</td>
<td>См. <a href="#guest-schema">схему объекта guest</a></td>
<td>Гости</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='passenger-schema'>Объект <code>passenger</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Ivan&quot;</td>
<td>Имя</td>
<td>Да</td>
</tr>
<tr>
<td>middle_name</td>
<td>String</td>
<td>&quot;Aleksandrovich&quot;</td>
<td>Отчество</td>
<td>Нет</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Ivanon&quot;</td>
<td>Фамилия</td>
<td>Да</td>
</tr>
<tr>
<td>document_type</td>
<td>String</td>
<td>&quot;international_passport&quot; (&quot;local_passport&quot;, &quot;birth_certificate&quot;)</td>
<td>Тип документа</td>
<td>Да</td>
</tr>
<tr>
<td>document_number</td>
<td>String</td>
<td>&quot;349287349&quot;</td>
<td>Номер документа</td>
<td>Да</td>
</tr>
<tr>
<td>birth_date</td>
<td>String</td>
<td>&quot;1987-07-18&quot;</td>
<td>Дата рождения</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='guest-schema'>Объект <code>guest</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Ivan&quot;</td>
<td>Имя</td>
<td>Да</td>
</tr>
<tr>
<td>middle_name</td>
<td>String</td>
<td>&quot;Aleksandrovich&quot;</td>
<td>Отчество</td>
<td>Нет</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Ivanon&quot;</td>
<td>Фамилия</td>
<td>Да</td>
</tr>
<tr>
<td>birth_date</td>
<td>String</td>
<td>&quot;1987-07-18&quot;</td>
<td>Дата рождения</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='segment-schema-airline'>Объект <code>segment</code> при <code>product_type == 'airline_tickets'</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>pnr</td>
<td>String</td>
<td>&#39;P52DKC&#39;</td>
<td>PNR сегмента</td>
<td>Да</td>
</tr>
<tr>
<td>flights</td>
<td>Array</td>
<td>См. <a href="#flight-schema">схему объекта flight</a></td>
<td>Перелеты</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='segment-schema-railway'>Объект <code>segment</code> при <code>product_type == 'railway_tickets'</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>routes</td>
<td>Array</td>
<td>См. <a href="#route-schema">схему объекта route</a></td>
<td>Сегменты пути</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='flight-schema'>Объект <code>flight</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>cabin_type</td>
<td>String</td>
<td>&quot;economy&quot; (&quot;business&quot;, &quot;premium&quot;)</td>
<td>Класс обслуживания</td>
<td>Нет</td>
</tr>
<tr>
<td>aircraft</td>
<td>String</td>
<td>&quot;737&quot;</td>
<td>Модель самолета</td>
<td>Да</td>
</tr>
<tr>
<td>departure_dt</td>
<td>DateTime</td>
<td>&quot;2016-12-10T08:00:00+03:00&quot;</td>
<td>Время вылета</td>
<td>Да</td>
</tr>
<tr>
<td>arrival_dt</td>
<td>DateTime</td>
<td>&quot;2018-12-10T10:00:00+03:00&quot;</td>
<td>Время прилета</td>
<td>Да</td>
</tr>
<tr>
<td>book_code</td>
<td>String</td>
<td>&quot;Y&quot;</td>
<td>Код бронирования</td>
<td>Да</td>
</tr>
<tr>
<td>orig</td>
<td>String</td>
<td>&quot;SVO&quot;</td>
<td>Аэропорт вылета</td>
<td>Да</td>
</tr>
<tr>
<td>dest</td>
<td>String</td>
<td>&quot;VIE&quot;</td>
<td>Аэропорт прилета</td>
<td>Да</td>
</tr>
<tr>
<td>flight_number</td>
<td>String</td>
<td>&quot;606&quot;</td>
<td>Номер рейса</td>
<td>Да</td>
</tr>
<tr>
<td>marketing_ac</td>
<td>String</td>
<td>&quot;SU&quot;</td>
<td>Маркетинговый перевозчик</td>
<td>Да</td>
</tr>
<tr>
<td>operating_ac</td>
<td>String</td>
<td>&quot;SU&quot;</td>
<td>Оперирующий перевозчик</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='route-schema'>Объект <code>route</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>service_class</td>
<td>String</td>
<td>&quot;ЗЛ&quot;</td>
<td>Класс обслуживания</td>
<td>Да</td>
</tr>
<tr>
<td>departure_dt</td>
<td>DateTime</td>
<td>&quot;2016-12-10T08:00:00+03:00&quot;</td>
<td>Дата и время отправления</td>
<td>Да</td>
</tr>
<tr>
<td>from_station</td>
<td>String</td>
<td>&quot;МОСКВА ОКТЯБРЬСКАЯ&quot;</td>
<td>Станция отправления</td>
<td>Да</td>
</tr>
<tr>
<td>to_station</td>
<td>String</td>
<td>&quot;САНКТ-ПЕТЕРБУРГ-ГЛАВН.&quot;</td>
<td>Станция прибытия</td>
<td>Да</td>
</tr>
<tr>
<td>train_number</td>
<td>String</td>
<td>&quot;606&quot;</td>
<td>Номер поезда</td>
<td>Да</td>
</tr>
<tr>
<td>car_number</td>
<td>String</td>
<td>&quot;6&quot;</td>
<td>Номер вагона</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='accommodation-schema'>Объект <code>accommodation</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>String</td>
<td>&quot;hotel&quot;</td>
<td>Тип размещения</td>
<td>Да</td>
</tr>
<tr>
<td>price</td>
<td>Decimal</td>
<td>100</td>
<td>Полная стоимость размещения</td>
<td>Да</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>&quot;Royal Resort&quot;</td>
<td>Название места размещения</td>
<td>Да</td>
</tr>
<tr>
<td>country</td>
<td>String</td>
<td>&quot;France&quot;</td>
<td>Страна размещения</td>
<td>Да</td>
</tr>
<tr>
<td>city</td>
<td>String</td>
<td>&quot;Nice&quot;</td>
<td>Город размещения</td>
<td>Да</td>
</tr>
<tr>
<td>room_type</td>
<td>String</td>
<td>&quot;Single&quot;</td>
<td>Категория размещения</td>
<td>Да</td>
</tr>
<tr>
<td>checkin_date</td>
<td>Date</td>
<td>&quot;2020-01-10&quot;</td>
<td>Дата заезда</td>
<td>Да</td>
</tr>
<tr>
<td>checkout_date</td>
<td>Date</td>
<td>&quot;2020-01-15&quot;</td>
<td>Дата выезда</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='local-passport-schema'>Объект общегражданского паспорта <code>local_passport</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>birth_date</td>
<td>Date</td>
<td>&quot;1987-07-18&quot;</td>
<td>Дата рождения</td>
<td>Да</td>
</tr>
<tr>
<td>birth_place</td>
<td>String</td>
<td>&quot;Россия, г. Москва, ул. Ленина, д. 5&quot;</td>
<td>Место рождения</td>
<td>Нет</td>
</tr>
<tr>
<td>issue_date</td>
<td>Date</td>
<td>&quot;2001-01-01&quot;</td>
<td>Дата выдачи паспорта</td>
<td>Да</td>
</tr>
<tr>
<td>number</td>
<td>String</td>
<td>&quot;4444333222&quot;</td>
<td>Серия и номер паспорта</td>
<td>Да</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Иванов&quot;</td>
<td>Фамилия</td>
<td>Да</td>
</tr>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Иван&quot;</td>
<td>Имя</td>
<td>Да</td>
</tr>
<tr>
<td>middle_name</td>
<td>String</td>
<td>&quot;Александрович&quot;</td>
<td>Отчество</td>
<td>Да</td>
</tr>
<tr>
<td>sex</td>
<td>String: &quot;female&quot;, &quot;male&quot;</td>
<td>&quot;female&quot;</td>
<td>Пол по паспорту</td>
<td>Да</td>
</tr>
<tr>
<td>issuing_authority</td>
<td>String</td>
<td>&quot;ОВД Района Калитники&quot;</td>
<td>Кем выдан</td>
<td>Да</td>
</tr>
<tr>
<td>authority_code</td>
<td>String</td>
<td>&quot;663402&quot;</td>
<td>Код подразделения</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='address-schema'>Объект адреса <code>address</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>city</td>
<td>String</td>
<td>&quot;Москва&quot;</td>
<td>Город</td>
<td>Да</td>
</tr>
<tr>
<td>street</td>
<td>String</td>
<td>&quot;ул. Китобойцев&quot;</td>
<td>Улица</td>
<td>Да</td>
</tr>
<tr>
<td>building</td>
<td>String</td>
<td>&quot;3&quot;</td>
<td>Дом</td>
<td>Да</td>
</tr>
<tr>
<td>housing</td>
<td>String</td>
<td>&quot;1&quot;</td>
<td>Строение</td>
<td>Нет</td>
</tr>
<tr>
<td>apartment</td>
<td>String</td>
<td>&quot;616&quot;</td>
<td>Квартира</td>
<td>Нет</td>
</tr>
<tr>
<td>postcode</td>
<td>String</td>
<td>&quot;111123&quot;</td>
<td>Почтовый индекс</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='international-passport-schema'>Объект загранпаспорта <code>international_passport</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>country_code</td>
<td>String</td>
<td>&quot;RU&quot;</td>
<td>Код страны</td>
<td>Да</td>
</tr>
<tr>
<td>birth_date</td>
<td>Date</td>
<td>&quot;1987-07-18&quot;</td>
<td>Дата рождения</td>
<td>Да</td>
</tr>
<tr>
<td>expiration_date</td>
<td>Date</td>
<td>&quot;2020-01-01&quot;</td>
<td>Срок истечения</td>
<td>Да</td>
</tr>
<tr>
<td>number</td>
<td>String</td>
<td>&quot;723902034&quot;</td>
<td>Номер</td>
<td>Да</td>
</tr>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Ivanov&quot;</td>
<td>Имя</td>
<td>Да</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Ivan&quot;</td>
<td>Фамилия</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='meta-schema'>Объект <code>meta</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>client_orders_count</td>
<td>Integer</td>
<td>14</td>
<td>Количество успешных заказов клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>client_login</td>
<td>Boolean</td>
<td>true/false</td>
<td>Статус клиента (залогинен или нет)</td>
<td>Нет</td>
</tr>
<tr>
<td>orders_count</td>
<td>Integer</td>
<td>3</td>
<td>Сумма заказов клиента у партнера</td>
<td>Нет</td>
</tr>
<tr>
<td>book_code</td>
<td>String</td>
<td>&quot;Y&quot;</td>
<td>Код бронирования</td>
<td>Нет</td>
</tr>
<tr>
<td>original_provider_order_id</td>
<td>String</td>
<td>&quot;AB123-45&quot;</td>
<td>Идентификатор заказа в системе партнера</td>
<td>Нет</td>
</tr>
</tbody></table>

<h4 id='product-schema'>Объект <code>product</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>product_type</td>
<td>String</td>
<td>&quot;airline_tickets&quot;, &quot;railway_tickets&quot;</td>
<td>Тип билетов</td>
<td>Да</td>
</tr>
<tr>
<td>product_items</td>
<td>Array</td>
<td>См. <a href="#product-items">схему объекта product_items</a></td>
<td>Список билетов и маршрутных квитанций</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='product-item-schema'>Объект <code>product_items</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>ticket_number</td>
<td>String</td>
<td>&quot;421-288879826&quot;</td>
<td>Номер билета</td>
<td>Да</td>
</tr>
<tr>
<td>ticket_receipt</td>
<td>File</td>
<td>@path/to/file/test_pdf.pdf</td>
<td>Файл маршрутной квитанции (pdf, doc, docx). Не больше 8MB</td>
<td>Да</td>
</tr>
</tbody></table>

<h2 id='payment-cards'>Тестовые карты</h2>

<table><thead>
<tr>
<th>Номер карты</th>
<th>CVV</th>
<th>Срок действия</th>
<th>Результат</th>
</tr>
</thead><tbody>
<tr>
<td>4111111111111112</td>
<td>123</td>
<td>2021/12</td>
<td>успешный платеж без 3DS с опциональным CVV</td>
</tr>
<tr>
<td>4111111111100031</td>
<td>123</td>
<td>2021/12</td>
<td>успешный платеж без 3DS с опциональным CVV</td>
</tr>
<tr>
<td>4111111111100023</td>
<td>123</td>
<td>2021/12</td>
<td>успешный платеж без 3DS с обязательным CVV</td>
</tr>
<tr>
<td>5486732058864471</td>
<td>123</td>
<td>2021/12</td>
<td>успешный платеж с 3DS</td>
</tr>
<tr>
<td>4111111111111111</td>
<td>123</td>
<td>2021/12</td>
<td>успешный платеж с 3DS</td>
</tr>
<tr>
<td>4111111111111114</td>
<td>123</td>
<td>2021/12</td>
<td>неуспешный платеж с 3DS</td>
</tr>
<tr>
<td>4111111111111115</td>
<td>123</td>
<td>2021/12</td>
<td>неуспешный платеж с 3DS</td>
</tr>
<tr>
<td>7000000000000007</td>
<td>521</td>
<td>2021/12</td>
<td>неуспешный платеж («недостаточно средств»)</td>
</tr>
<tr>
<td>8000000000000008</td>
<td>521</td>
<td>2021/12</td>
<td>неуспешный платеж («неверный срок действия карты»)</td>
</tr>
<tr>
<td>7600000000000006</td>
<td>521</td>
<td>2021/12</td>
<td>неуспешный платеж («номер карты в черном списке»)</td>
</tr>
<tr>
<td>1234561999999999</td>
<td>374</td>
<td>2021/12</td>
<td>неуспешный платеж («несуществующая карта»)</td>
</tr>
<tr>
<td>4111101000000046</td>
<td>123</td>
<td>2021/12</td>
<td>неуспешный платеж («недостаточно средств») во время блокировки (при превышении суммы в 100 рублей (Amount=10001))</td>
</tr>
<tr>
<td>4100401111100062</td>
<td>123</td>
<td>2021/12</td>
<td>Таймаут 40 секунд во время блокировки</td>
</tr>
<tr>
<td>4100401111100724</td>
<td>123</td>
<td>2021/12</td>
<td>Таймаут 40 секунд во время разблокировки</td>
</tr>
<tr>
<td>4100401111100328</td>
<td>123</td>
<td>2021/12</td>
<td>Таймаут 40 секунд во время списания</td>
</tr>
<tr>
<td>4100401111103025</td>
<td>123</td>
<td>2021/12</td>
<td>Таймаут 40 секунд во время возврата</td>
</tr>
</tbody></table>

<h1 id='v1-eng'> [ENG] API v1 </h1>

<h2 id='introduction-eng'>General Information</h2>

<p>Moneywall is an online credit service, which can be built into partner checkout pages and allow customers to buy a product on credit.</p>

<p>An API works on HTTPS protocol, all data is presented in JSON format.</p>

<p>Base URL –  <code>https://dev.moneywall.io/api/partners</code></p>

<p>A simple scenario of application submitting and processing:</p>

<ol>
<li> Method invocation <a href="#payment-init-eng">Start of a payment session</a></li>
<li> Output of a frame window on the link from search results</li>
<li> User input</li>
<li> Redirecting user to URL from <code>redirect_url</code></li>
<li> Waiting for a decision on the application</li>
<li> Invocation of <code>success_callback_url</code>  or  <code>failure_callback_url</code>  when the application is approved or rejected, respectively</li>
</ol>

<h3 id='calc-eng'>Price Calculation Formula</h3>

<p>To calculate and display payments and the total cost of the order on partner side, a simplified formula is used
<code>payment = (order sum * K) / 3,</code></p>

<p>where  <code>K = 1.10</code>  if the flight is scheduled after the credit agreement expires (later than 60 days from the date of application),
and  <code>K = 1.21</code> if the flight is scheduled before the credit agreement expires</p>

<h2 id='auth-eng'>Authentification</h2>

<p>Authentification occurs through partner token, passed in Authorization on each request:</p>

<p><code>Authorization: SuperSecretTokenValue</code></p>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/init"</span>
 -H <span class="s2">"Authorization: SuperSecretTokenValue"</span>
</code></pre>
<aside class="notice">
Please replace `SuperSecretTokenValue` with the token given to you
</aside>

<h2 id='payments-eng'>Payment Sessions</h2>

<h3 id='payments-init-eng'>Start of a Payment Session</h3>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/init"</span>
 -X POST
 -H <span class="s2">"Content-Type: application/json"</span>
 -H <span class="s2">"Authorization: SuperSecretTokenValue"</span>
 -d <span class="s1">'{ "phone": "79031232299", "email": "test@test.com", "amount": 10000, "calculated_credit_cost": 12000, "success_callback_url": "http://yoursite.com/callbacks/success", "failure_callback_url": "http://yoursite.com/callbacks/failure", "redirect_url": "http://yoursite.com/order/234", "order_id": "partner_order_id", "web_mode": "standalone", "original_provider_order_id": "original_provider_order_id", "expires_at": "2017-07-01T00:00:00", "product_type": "airline_tickets" }'</span>
</code></pre>
<blockquote>
<p>The above call returns a response in JSON of the following type</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
 </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span><span class="w">
 </span><span class="s2">"frame_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://dev.moneywall.io/frame/credit_applications/10/payment_graph"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>The method is used to start start a credit application procedure</p>

<p><strong>HTTP Request</strong></p>

<p><code>POST https://dev.moneywall.io/api/partners/payments/init</code></p>

<p><strong>Query schema</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>phone</td>
<td>String</td>
<td>&quot;79588249424&quot;</td>
<td>Customer&#39;s telephone number</td>
<td>Yes</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>&quot;user@gmail.com&quot;</td>
<td>Customer&#39;s e-mail address</td>
<td>Yes</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>10000</td>
<td>The sum of the customer&#39;s order on partner website in rubles</td>
<td>Yes</td>
</tr>
<tr>
<td>success_callback_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/callbacks/success&quot;</td>
<td>URL of callback-page, called when the application is approved</td>
<td>Yes</td>
</tr>
<tr>
<td>failure_callback_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/callbacks/failure&quot;</td>
<td>URL of callback-page, called when the application is rejected</td>
<td>Yes</td>
</tr>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Session ID on partner side (which will allow to <a href="#payment-state-eng">receive status</a>)</td>
<td>Yes</td>
</tr>
<tr>
<td>web_mode</td>
<td>String: &quot;standalone&quot;, &quot;iframe&quot;</td>
<td>&quot;standalone&quot;</td>
<td>The mode in which the application form will be opened (default: standalone)</td>
<td>No</td>
</tr>
<tr>
<td>&quot;AB123-45&quot;</td>
<td>Order ID in partner system</td>
<td>No</td>
<td>expires_at</td>
<td>DateTime</td>
</tr>
<tr>
<td>product_type</td>
<td>String</td>
<td>&quot;airline_tickets&quot;/&quot;railway_tickets&quot;</td>
<td>The type of product, to buy which a credit is granted</td>
<td>product</td>
</tr>
<tr>
<td>local_passport</td>
<td>Object</td>
<td>See  <a href="#local-passport-schema-eng">local_passport schema</a></td>
<td>Customer&#39;s state ID card</td>
<td>No</td>
</tr>
<tr>
<td>international_passport</td>
<td>Object</td>
<td>See  <a href="#international-passport-schema-eng">international_passport schema</a></td>
<td>Customer&#39;s international passport</td>
<td>No</td>
</tr>
</tbody></table>

<blockquote>
<p>Please, note that parameters of DateTime type should be passed in ISO8601 format with the time zone. The recommended date format:  <code>&quot;%Y-%m-%dT%H:%M:%S%:z&quot;</code></p>
</blockquote>

<h3 id='product-add-eng'>Adding issued tickets to the order</h3>
<pre class="highlight shell tab-shell"><code>curl -X POST   <span class="se">\</span>
-H <span class="s1">'Authorization: SuperSecretTokenValue'</span> <span class="se">\</span>
-F <span class="s1">'order_id=partner_order_id'</span> <span class="se">\</span>
-F <span class="s1">'product[product_type]=airline_tickets'</span> <span class="se">\</span>
-F <span class="s1">'product[product_items][][ticket_number]=123'</span> <span class="se">\</span>
-F <span class="s1">'product[product_items][][ticket_receipt]=@path/to/file/test_pdf.pdf'</span> <span class="se">\</span>
https://dev.moneywall.io/api/partners/payments/product
</code></pre>
<p>This action adds ticket numbers and ticket receipts into credit application</p>

<p><strong>HTTP Request</strong></p>

<p><code>POST https://dev.moneywall.io/api/partners/payments/product</code></p>

<p><strong>URL parameters</strong>
Parameter | Type | Example | Description | Mandatory
--------- | --------- | --------- | --------- | ---------
order_id | String | &quot;vpih-234lgh&quot; | Payment session ID, passed to the method of starting a payment session | Yes
transaction_letter | File | @path/to/file/test_pdf.pdf | Transaction letter | No
product | Object | See <a href="#product-eng">product schema</a> | Issued tickets | Yes</p>

<h3 id='payments-state-eng'>Payment Session Status</h3>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/state?order_id=partner_order_id"</span>
 -H <span class="s2">"Authorization: SuperSecretTokenValue"</span>
</code></pre>
<blockquote>
<p>The action above returns a response in JSON of the following type</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
 </span><span class="s2">"order_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"partner_order_id"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"processing"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<aside class="notice">The method returns a credit application status in Moneywall system</aside>

<p><strong>HTTP Request</strong></p>

<p><code>GET https://dev.moneywall.io/api/partners/payments/state</code></p>

<p><strong>URL parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Payment session id, passed to the method of starting a payment session</td>
<td>Yes</td>
</tr>
</tbody></table>

<p><strong>Statuses list</strong></p>

<p>For a description of the cancellation and closing flow for returns, see <a href="#payment-refund-eng">refunds</a>.</p>

<table><thead>
<tr>
<th>Status&nbsp;code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>processing</td>
<td>Payment processing</td>
</tr>
<tr>
<td>cancelled</td>
<td>Payment session cancelled</td>
</tr>
<tr>
<td>authorized</td>
<td>The first payment is made, the credit agreement is concluded</td>
</tr>
<tr>
<td>voided</td>
<td>The first payment is refunded to the customer, the credit agreement is cancelled</td>
</tr>
<tr>
<td>refunded</td>
<td>The full refund under the agreement is made</td>
</tr>
<tr>
<td>charged</td>
<td>The first payment is charged, refund is possible only by early refund and agreement closing</td>
</tr>
</tbody></table>

<h3 id='payments-states-array-eng'>List of payment sessions statuses for a period</h3>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/states?from=2019-01-01T23:35:14+0300&amp;till=2019-01-13T00:02:13+0300"</span>
 -H <span class="s2">"Authorization: token"</span>

</code></pre>
<blockquote>
<p>The action returns a response in JSON of the following type:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
 </span><span class="p">{</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"partner_order_id_1"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"processing"</span><span class="w">
 </span><span class="p">},</span><span class="w">
 </span><span class="p">{</span><span class="w">
   </span><span class="s2">"order_id"</span><span class="p">:</span><span class="s2">"partner_order_id_2"</span><span class="p">,</span><span class="w">
   </span><span class="s2">"state"</span><span class="p">:</span><span class="s2">"cancelled"</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">

</span></code></pre>
<p>The method returns credit application statuses in Moneywall system for a period</p>

<p><strong>HTTP Request</strong></p>

<p><code>GET https://dev.moneywall.io/api/partners/payments/states</code></p>

<p><strong>URL parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>from</td>
<td>DateTime</td>
<td>&quot;2019-01-01T23:35:14+0300&quot;</td>
<td>Time of period start</td>
<td>Yes</td>
</tr>
<tr>
<td>till</td>
<td>DateTime</td>
<td>&quot;2019-01-13T00:02:13+0300&quot;</td>
<td>Time of period end</td>
<td>Yes</td>
</tr>
</tbody></table>

<h3 id='payment-refund-eng'>Refund</h3>
<pre class="highlight plaintext"><code>curl "https://dev.moneywall.io/api/partners/payments/refund"
 -X POST
 -H "Content-Type: application/json"
 -H "Authorization: SuperSecretTokenValue"
 -d '{ "amount": 100, "order_id": "partner_order_id" }'


</code></pre>
<blockquote>
<p>The action above returns the following response:</p>
</blockquote>
<pre class="highlight plaintext"><code>HTTP status `200`, if the request was processed. Any other status means that the request was not processed.

</code></pre>
<p>The is used for making a partial or full refund for order</p>

<p>A partial refund causes the accounting of funds in favour of the debt for a loan.
A full refund causes closing of a loan.</p>

<p><strong>Transitions between agreement statuses</strong></p>

<p>An agreement is considered to be finally opened and confirmed 24 hours after its initial opening.<br/>
An agreement can be canceled within 24 hours after its initial opening.</p>

<p>Consequently:</p>

<ul>
<li>  In case of a full refund within 24 hours after the agreement opening, the agreement is canceled and the money is returned to the client&#39;s card by voiding of the payment session;</li>
<li>  In case of a full refund later than 24 hours after the agreement opening, the payment is considered as a refund.</li>
</ul>

<p><strong>HTTP Request</strong></p>

<p><code>POST https://dev.moneywall.io/api/partners/payments/refund</code></p>

<p><strong>URL parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Payments session ID, passed to the method <a href="#payment-init-eng">start of a payment session</a></td>
<td>Yes</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>100</td>
<td>Repayment in rubles</td>
<td>Yes</td>
</tr>
<tr>
<td>currency</td>
<td>String</td>
<td>&#39;RUB&#39;</td>
<td>Currency code in ISO-4217 format</td>
<td>No</td>
</tr>
<tr>
<td>document_number</td>
<td>String</td>
<td>&#39;987654321&#39;</td>
<td>The number of the document issued for the ticket / service for which the refund is requested within the order</td>
<td>No</td>
</tr>
</tbody></table>

<h2 id='entity-schemas-eng'>Objects and Entities</h2>

<h4 id='product-schema-airline-eng'>Schema of <code>product</code> when <code>product_type == 'airline_tickets'</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>cabin_type</td>
<td>String</td>
<td>&quot;economy&quot; (&quot;business&quot;, &quot;premium&quot;)</td>
<td>Class</td>
<td>Yes</td>
</tr>
<tr>
<td>validating_airline</td>
<td>String</td>
<td>&quot;SU&quot;</td>
<td>Validating carrier</td>
<td>Yes</td>
</tr>
<tr>
<td>segments</td>
<td>Array</td>
<td>See  <a href="#segment-schema-eng">segment schema</a></td>
<td>Segments</td>
<td>Yes</td>
</tr>
<tr>
<td>passengers</td>
<td>Array</td>
<td>See  <a href="#passenger-eng">passenger schema</a></td>
<td>Passengers</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='product-schema-railway-eng'>Schema of <code>product</code> when <code>product_type == 'railway_tickets'</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>segments</td>
<td>Array</td>
<td>See  <a href="#segment-schema-eng">segment schema</a></td>
<td>Segments</td>
<td>Yes</td>
</tr>
<tr>
<td>passengers</td>
<td>Array</td>
<td>See  <a href="#passenger-eng">passenger schema</a></td>
<td>Passengers</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='product-schema-accommodation-eng'>Schema of <code>product</code> when <code>product_type == 'accomodation'</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>accommodations</td>
<td>Array</td>
<td>См. <a href="#accommodation-schema">accommodation schema</a></td>
<td>Accomodation options</td>
<td>Yes</td>
</tr>
<tr>
<td>guests</td>
<td>Array</td>
<td>См. <a href="#guest-schema">guest schema</a></td>
<td>Guests</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='passenger-schema-eng'>Schema of <code>passenger</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Ivan&quot;</td>
<td>Name</td>
<td>Yes</td>
</tr>
<tr>
<td>middle_name</td>
<td>String</td>
<td>&quot;Aleksandrovich&quot;</td>
<td>Patronymic</td>
<td>No</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Ivanov&quot;</td>
<td>Surname</td>
<td>Yes</td>
</tr>
<tr>
<td>document_type</td>
<td>String</td>
<td>&quot;international_passport&quot; (&quot;local_passport&quot;, &quot;birth_certificate&quot;)</td>
<td>Document type</td>
<td>Yes</td>
</tr>
<tr>
<td>document_number</td>
<td>String</td>
<td>&quot;349287349&quot;</td>
<td>Document number</td>
<td>Yes</td>
</tr>
<tr>
<td>birth_date</td>
<td>String</td>
<td>&quot;1987-07-18&quot;</td>
<td>Date of birth</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='guest-schema-eng'>Schema of <code>guest</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Ivan&quot;</td>
<td>First name</td>
<td>Yes</td>
</tr>
<tr>
<td>middle_name</td>
<td>String</td>
<td>&quot;Aleksandrovich&quot;</td>
<td>Patronymic</td>
<td>No</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Ivanon&quot;</td>
<td>Last name</td>
<td>Yes</td>
</tr>
<tr>
<td>birth_date</td>
<td>String</td>
<td>&quot;1987-07-18&quot;</td>
<td>Date of birth</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='segment-schema-airline-eng'>Schema of <code>segment</code> when <code>product_type == 'airline_tickets'</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>pnr</td>
<td>String</td>
<td>&#39;P52DKC&#39;</td>
<td>PNR of segment</td>
<td>Yes</td>
</tr>
<tr>
<td>flights</td>
<td>Array</td>
<td>See <a href="#flight-schema-eng">flight schema</a></td>
<td>Routes</td>
<td>Yes</td>
</tr>
<tr>
<td>routes</td>
<td>Array</td>
<td>See  <a href="#route-schema-eng">route schema</a></td>
<td>Routes</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='segment-schema-railway-eng'>Schema of <code>segment</code> when <code>product_type == 'railway_tickets'</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>routes</td>
<td>Array</td>
<td>See  <a href="#route-schema-eng">route schema</a></td>
<td>Routes</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='flight-schema-eng'>Schema of <code>flight</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>cabin_type</td>
<td>String</td>
<td>&quot;economy&quot; (&quot;business&quot;, &quot;premium&quot;)</td>
<td>Class</td>
<td>No</td>
</tr>
<tr>
<td>aircraft</td>
<td>String</td>
<td>&quot;737&quot;</td>
<td>Aircraft</td>
<td>Yes</td>
</tr>
<tr>
<td>departure_dt</td>
<td>DateTime</td>
<td>&quot;2016-12-10T08:00:00+03:00&quot;</td>
<td>Departure date and time</td>
<td>Yes</td>
</tr>
<tr>
<td>arrival_dt</td>
<td>DateTime</td>
<td>&quot;2018-12-10T10:00:00+03:00&quot;</td>
<td>Arrival date and time</td>
<td>Yes</td>
</tr>
<tr>
<td>book_code</td>
<td>String</td>
<td>&quot;Y&quot;</td>
<td>Booking code</td>
<td>Yes</td>
</tr>
<tr>
<td>orig</td>
<td>String</td>
<td>&quot;SVO&quot;</td>
<td>Departure airport</td>
<td>Yes</td>
</tr>
<tr>
<td>dest</td>
<td>String</td>
<td>&quot;VIE&quot;</td>
<td>Arrival airport</td>
<td>Yes</td>
</tr>
<tr>
<td>flight_number</td>
<td>String</td>
<td>&quot;606&quot;</td>
<td>Flight</td>
<td>Yes</td>
</tr>
<tr>
<td>marketing_ac</td>
<td>String</td>
<td>&quot;SU&quot;</td>
<td>Marketing carrier</td>
<td>Yes</td>
</tr>
<tr>
<td>operating_ac</td>
<td>String</td>
<td>&quot;SU&quot;</td>
<td>Operating carrier</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='route-schema-eng'>Schema of <code>route</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>service_class</td>
<td>String</td>
<td>&quot;ЗЛ&quot;</td>
<td>Class</td>
<td>Yes</td>
</tr>
<tr>
<td>departure_dt</td>
<td>DateTime</td>
<td>&quot;2016-12-10T08:00:00+03:00&quot;</td>
<td>Departure date and time</td>
<td>Yes</td>
</tr>
<tr>
<td>from_station</td>
<td>String</td>
<td>&quot;MOSKVA OKTYABRSKAYA&quot;</td>
<td>From</td>
<td>Yes</td>
</tr>
<tr>
<td>to_station</td>
<td>String</td>
<td>&quot;SANKT-PETERBURG-GLAVNII&quot;</td>
<td>To</td>
<td>Yes</td>
</tr>
<tr>
<td>train_number</td>
<td>String</td>
<td>&quot;606&quot;</td>
<td>Train</td>
<td>Yes</td>
</tr>
<tr>
<td>car_number</td>
<td>String</td>
<td>&quot;6&quot;</td>
<td>Coach</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='accommodation-schema-eng'>Schema of <code>accommodation</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>String</td>
<td>&quot;hotel&quot;</td>
<td>Accomodation type</td>
<td>Yes</td>
</tr>
<tr>
<td>price</td>
<td>Decimal</td>
<td>100</td>
<td>Total cost</td>
<td>Yes</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>&quot;Royal Resort&quot;</td>
<td>Accomodation name</td>
<td>Yes</td>
</tr>
<tr>
<td>country</td>
<td>String</td>
<td>&quot;France&quot;</td>
<td>Country</td>
<td>Yes</td>
</tr>
<tr>
<td>city</td>
<td>String</td>
<td>&quot;Nice&quot;</td>
<td>City</td>
<td>Yes</td>
</tr>
<tr>
<td>room_type</td>
<td>String</td>
<td>&quot;Single&quot;</td>
<td>Room type</td>
<td>Yes</td>
</tr>
<tr>
<td>checkin_date</td>
<td>Date</td>
<td>&quot;2020-01-10&quot;</td>
<td>Date of checkin</td>
<td>Yes</td>
</tr>
<tr>
<td>checkout_date</td>
<td>Date</td>
<td>&quot;2020-01-15&quot;</td>
<td>Date of checkout</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='local-passport-schema-eng'>Schema of state ID card <code>local_passport</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>birth_date</td>
<td>Date</td>
<td>&quot;1987-07-18&quot;</td>
<td>Date of birth</td>
<td>Yes</td>
</tr>
<tr>
<td>birth_place</td>
<td>String</td>
<td>&quot;Lenin St. 5, Moscow, Russia&quot;</td>
<td>Place of birth</td>
<td>No</td>
</tr>
<tr>
<td>issue_date</td>
<td>Date</td>
<td>&quot;2001-01-01&quot;</td>
<td>Date of issue</td>
<td>Yes</td>
</tr>
<tr>
<td>number</td>
<td>String</td>
<td>&quot;4444333222&quot;</td>
<td>Series and number of ID card</td>
<td>Yes</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Ivanov&quot;</td>
<td>Surname</td>
<td>Yes</td>
</tr>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Ivan&quot;</td>
<td>Name</td>
<td>Yes</td>
</tr>
<tr>
<td>middle_name</td>
<td>String</td>
<td>&quot;Aleksandrovich&quot;</td>
<td>Patronymic</td>
<td>Yes</td>
</tr>
<tr>
<td>sex</td>
<td>String: &quot;female&quot;, &quot;male&quot;</td>
<td>&quot;female&quot;</td>
<td>Sex in ID card</td>
<td>Yes</td>
</tr>
<tr>
<td>issuing_authority</td>
<td>String</td>
<td>&quot;OVD Rayona Kalitniki&quot;</td>
<td>Issuing authority</td>
<td>Yes</td>
</tr>
<tr>
<td>authority_code</td>
<td>String</td>
<td>&quot;663402&quot;</td>
<td>Authority code</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='address-schema-eng'>Schema of <code>address</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>city</td>
<td>String</td>
<td>&quot;Moscow&quot;</td>
<td>City</td>
<td>Yes</td>
</tr>
<tr>
<td>street</td>
<td>String</td>
<td>&quot;Kitoboytsev St.&quot;</td>
<td>Street</td>
<td>Yes</td>
</tr>
<tr>
<td>building</td>
<td>String</td>
<td>&quot;3&quot;</td>
<td>Number</td>
<td>Yes</td>
</tr>
<tr>
<td>housing</td>
<td>String</td>
<td>&quot;1&quot;</td>
<td>Building</td>
<td>No</td>
</tr>
<tr>
<td>apartment</td>
<td>String</td>
<td>&quot;616&quot;</td>
<td>Flat</td>
<td>No</td>
</tr>
<tr>
<td>postcode</td>
<td>String</td>
<td>&quot;111123&quot;</td>
<td>Postcode</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='international-passport-schema-eng'>Schema of <code>international_passport</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>country_code</td>
<td>String</td>
<td>&quot;RU&quot;</td>
<td>Country code</td>
<td>Yes</td>
</tr>
<tr>
<td>birth_date</td>
<td>Date</td>
<td>&quot;1987-07-18&quot;</td>
<td>Date of birth</td>
<td>Yes</td>
</tr>
<tr>
<td>expiration_date</td>
<td>Date</td>
<td>&quot;2020-01-01&quot;</td>
<td>Expiration date</td>
<td>Yes</td>
</tr>
<tr>
<td>number</td>
<td>String</td>
<td>&quot;723902034&quot;</td>
<td>Number</td>
<td>Yes</td>
</tr>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Ivanov&quot;</td>
<td>Name</td>
<td>Yes</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Ivan&quot;</td>
<td>Surname</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='meta-schema-eng'>Schema <code>meta</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>client_orders_count</td>
<td>Integer</td>
<td>14</td>
<td>The number of customer&#39;s successful orders</td>
<td>No</td>
</tr>
<tr>
<td>client_login</td>
<td>Boolean</td>
<td>true/false</td>
<td>Customer&#39;s status (signed in or not)</td>
<td>No</td>
</tr>
<tr>
<td>orders_count</td>
<td>Integer</td>
<td>3</td>
<td>The sum of customer&#39;s orders at partner</td>
<td>No</td>
</tr>
<tr>
<td>book_code</td>
<td>String</td>
<td>&quot;Y&quot;</td>
<td>Booking code</td>
<td>No</td>
</tr>
<tr>
<td>original_provider_order_id</td>
<td>String</td>
<td>&quot;AB123-45&quot;</td>
<td>Order ID in partner system</td>
<td>No</td>
</tr>
</tbody></table>

<h4 id='product-schema-eng'>Schema of <code>product</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>product_type</td>
<td>String</td>
<td>&quot;airline_tickets&quot;, &quot;railway_tickets&quot;</td>
<td>Type of ticket</td>
<td>Yes</td>
</tr>
<tr>
<td>product_items</td>
<td>Array</td>
<td>See <a href="#product-items-eng">schema of product_items</a></td>
<td>A list of tickets and ticket receipts</td>
<td>Yes</td>
</tr>
</tbody></table>

<h4 id='product-item-schema-eng'>Schema of <code>product_items</code></h4>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
<th>Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>ticket_number</td>
<td>String</td>
<td>&quot;421-288879826&quot;</td>
<td>Number of ticket</td>
<td>Yes</td>
</tr>
<tr>
<td>ticket_receipt</td>
<td>File</td>
<td>@path/to/file/test_pdf.pdf</td>
<td>Ticket receipt file (pdf, doc, docx). Not exceeding 8MB</td>
<td>Yes</td>
</tr>
</tbody></table>

<h2 id='payment-cards-eng'>Test cards</h2>

<table><thead>
<tr>
<th>Card number</th>
<th>CVV</th>
<th>Valid through</th>
<th>Result</th>
</tr>
</thead><tbody>
<tr>
<td>4111111111111112</td>
<td>123</td>
<td>2021/12</td>
<td>Successful payment without 3DS with optional CVV</td>
</tr>
<tr>
<td>4111111111100031</td>
<td>123</td>
<td>2021/12</td>
<td>Successful payment without 3DS with optional CVV</td>
</tr>
<tr>
<td>4111111111100023</td>
<td>123</td>
<td>2021/12</td>
<td>Successful payment without 3DS with optional CVV</td>
</tr>
<tr>
<td>5486732058864471</td>
<td>123</td>
<td>2021/12</td>
<td>Successful payment with 3DS</td>
</tr>
<tr>
<td>4111111111111111</td>
<td>123</td>
<td>2021/12</td>
<td>Successful payment with 3DS</td>
</tr>
<tr>
<td>4111111111111114</td>
<td>123</td>
<td>2021/12</td>
<td>Unsuccessful payment with 3DS</td>
</tr>
<tr>
<td>4111111111111115</td>
<td>123</td>
<td>2021/12</td>
<td>Unsuccessful payment with 3DS</td>
</tr>
<tr>
<td>7000000000000007</td>
<td>521</td>
<td>2021/08</td>
<td>Unsuccessful payment («not sufficient funds»)</td>
</tr>
<tr>
<td>8000000000000008</td>
<td>521</td>
<td>2021/09</td>
<td>Unsuccessful payment («invalid expiration date»)</td>
</tr>
<tr>
<td>7600000000000006</td>
<td>521</td>
<td>2021/08</td>
<td>Unsuccessful payment («card number on blacklist»)</td>
</tr>
<tr>
<td>1234561999999999</td>
<td>374</td>
<td>2021/12</td>
<td>Unsuccessful payment («invalid card number»)</td>
</tr>
<tr>
<td>4111101000000046</td>
<td>123</td>
<td>2021/12</td>
<td>Unsuccessful payment («not sufficient funds») during authorization (upon exceeding the amount of 100 rubles (Amount=10001))</td>
</tr>
<tr>
<td>4100401111100062</td>
<td>123</td>
<td>2021/12</td>
<td>Timeout 40 seconds during authorization</td>
</tr>
<tr>
<td>4100401111100724</td>
<td>123</td>
<td>2021/12</td>
<td>Timeout 40 seconds during void</td>
</tr>
<tr>
<td>4100401111100328</td>
<td>123</td>
<td>2021/12</td>
<td>Timeout 40 seconds during charge</td>
</tr>
<tr>
<td>4100401111103025</td>
<td>123</td>
<td>2021/12</td>
<td>Timeout 40 seconds during refund</td>
</tr>
</tbody></table>

<h1 id='v2'> API v2 </h1>

<p>Ниже представлен проект документации по новой версии API</p>

<h2 id='entities-v2'>Системные сущности</h2>

<ul>
<li><p><a href="#credit-application-entity-v2">Кредитная Заявка</a></p></li>
<li><p><a href="#credit-agreement-entity-v2">Кредитный Договор</a></p></li>
<li><p><a href="#credit-signature-entity-v2">Электронная подпись</a></p></li>
<li><p><a href="#document-photo-entity-v2">Фотография Документа</a></p></li>
<li><p><a href="#social-profile-entity-v2">Профиль социальной сети</a></p></li>
<li><p><a href="#initial-payment-entity-v2">Первоначальный платеж</a></p></li>
<li><p><a href="#credit-card-entity-v2">Банковская карта</a></p></li>
<li><p><a href="#decision-entity-v2">Решение по заявке</a></p></li>
<li><p><a href="#credit-application-state-entity-v2">Текущий статус заявки</a></p></li>
<li><p><a href="#payment-graph-entity-v2">График платежей</a></p></li>
<li><p><a href="#scheduled-payment-entity-v2">Очередной платеж</a></p></li>
<li><p><a href="#payment-attempt-entity-v2">Попытка списания</a></p></li>
<li><p><a href="#charged-payment-entity-v2">Состоявшийся платеж</a></p></li>
<li><p><a href="#refunds-entity-v2">Список возвратов</a></p></li>
<li><p><a href="#refund-entity-v2">Возврат</a></p></li>
<li><p><a href="#activation-entity-v2">Ввод договора в действие</a></p></li>
<li><p><a href="#product-entity-v2">Товар</a></p></li>
</ul>

<h3 id='credit-application-entity-v2'> Кредитная заявка </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>phone</td>
<td>String</td>
<td>&quot;79588249424&quot;</td>
<td>Номер телефона клиента</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>&quot;user@gmail.com&quot;</td>
<td>Адрес электронной почты клиента</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>10000</td>
<td>Сумма заказа клиента на сайте партнера в рублях</td>
</tr>
<tr>
<td>success_callback_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/callbacks/success&quot;</td>
<td>Адрес callback-страницы, вызываемой при одобрении заявки</td>
</tr>
<tr>
<td>failure_callback_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/callbacks/failure&quot;</td>
<td>Адрес callback-страницы, вызываемой при отклонении заявки</td>
</tr>
<tr>
<td>redirect_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/order/AB123-45&quot;</td>
<td>Адрес страницы заказа в системе партнера</td>
</tr>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Идентификатор заказа со стороны партнера</td>
</tr>
<tr>
<td>original_provider_order_id</td>
<td>String</td>
<td>&quot;AB123-45&quot;</td>
<td>Идентификатор заказа в системе партнера</td>
</tr>
<tr>
<td>expires_at</td>
<td>DateTime</td>
<td>&quot;2017-09-01T15:00:00+03:00&quot;</td>
<td>Таймлимит для заказа</td>
</tr>
<tr>
<td>meta</td>
<td>Object</td>
<td>См. <a href="#meta-entity-v2">схему сущности meta</a></td>
<td>Дополнительная информация</td>
</tr>
</tbody></table>

<blockquote>
<p>Пожалуйста, обратите внимание, что параметры с типом DateTime следует передавать в формате ISO8601 с часовым поясом. Рекомендуемый формат даты: <code>&quot;%Y-%m-%dT%H:%M:%S%:z&quot;</code></p>
</blockquote>

<h3 id='credit-agreement-entity-v2'> Кредитный договор </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>1</td>
<td>ID договора</td>
</tr>
<tr>
<td>body_amount</td>
<td>Decimal</td>
<td>10000</td>
<td>Сумма тела займа</td>
</tr>
<tr>
<td>interest_amount</td>
<td>Decimal</td>
<td>2000</td>
<td>Сумма процентов займа</td>
</tr>
<tr>
<td>body_remainder_amount</td>
<td>Decimal</td>
<td>9000</td>
<td>Текущая задолженность по телу</td>
</tr>
<tr>
<td>interest_remainder_amount</td>
<td>Decimal</td>
<td>1000</td>
<td>Текущая задолженность по процентам</td>
</tr>
<tr>
<td>state</td>
<td>String</td>
<td>&#39;open&#39;</td>
<td>Статус договора</td>
</tr>
<tr>
<td>credit_application_id</td>
<td>Integer</td>
<td>ID кредитной заявки</td>
<td></td>
</tr>
</tbody></table>

<h3 id='credit-signature-entity-v2'> Электронная подпись </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>1</td>
<td>ID подписи</td>
</tr>
<tr>
<td>code</td>
<td>String</td>
<td>&#39;0312&#39;</td>
<td>Код</td>
</tr>
<tr>
<td>active</td>
<td>Boolean</td>
<td>true</td>
<td>Статус активности</td>
</tr>
<tr>
<td>expires_at</td>
<td>Datetime</td>
<td>&quot;2019-07-01T13:00:00+03:00&quot;</td>
<td>Срок активности</td>
</tr>
</tbody></table>

<h3 id='local-passport-entity-v2'> Общегражданский паспорт </h3>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>birth_date</td>
<td>Date</td>
<td>&quot;1987-07-18&quot;</td>
<td>Дата рождения</td>
</tr>
<tr>
<td>issue_date</td>
<td>Date</td>
<td>&quot;2001-01-01&quot;</td>
<td>Дата выдачи паспорта</td>
</tr>
<tr>
<td>number</td>
<td>String</td>
<td>&quot;4444333222&quot;</td>
<td>Серия и номер паспорта</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Иванов&quot;</td>
<td>Фамилия</td>
</tr>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Иван&quot;</td>
<td>Имя</td>
</tr>
<tr>
<td>middle_name</td>
<td>String</td>
<td>&quot;Александрович&quot;</td>
<td>Отчество</td>
</tr>
<tr>
<td>sex</td>
<td>String: &quot;female&quot;, &quot;male&quot;</td>
<td>&quot;female&quot;</td>
<td>Пол по паспорту</td>
</tr>
<tr>
<td>issuing_authority</td>
<td>String</td>
<td>&quot;ОВД Района Калитники&quot;</td>
<td>Кем выдан</td>
</tr>
<tr>
<td>authority_code</td>
<td>String</td>
<td>&quot;663402&quot;</td>
<td>Код подразделения</td>
</tr>
</tbody></table>

<h3 id='address-entity-v2'> Адрес регистрации </h3>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>city</td>
<td>String</td>
<td>&quot;Москва&quot;</td>
<td>Город</td>
</tr>
<tr>
<td>street</td>
<td>String</td>
<td>&quot;ул. Китобойцев&quot;</td>
<td>Улица</td>
</tr>
<tr>
<td>building</td>
<td>String</td>
<td>&quot;3&quot;</td>
<td>Дом</td>
</tr>
<tr>
<td>housing</td>
<td>String</td>
<td>&quot;1&quot;</td>
<td>Строение</td>
</tr>
<tr>
<td>apartment</td>
<td>String</td>
<td>&quot;616&quot;</td>
<td>Квартира</td>
</tr>
<tr>
<td>postcode</td>
<td>String</td>
<td>&quot;111123&quot;</td>
<td>Почтовый индекс</td>
</tr>
</tbody></table>

<h3 id='international-passport-entity-v2'> Заграничный паспорт </h3>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>country_code</td>
<td>String</td>
<td>&quot;RU&quot;</td>
<td>Код страны</td>
</tr>
<tr>
<td>birth_date</td>
<td>Date</td>
<td>&quot;1987-07-18&quot;</td>
<td>Дата рождения</td>
</tr>
<tr>
<td>expiration_date</td>
<td>Date</td>
<td>&quot;2020-01-01&quot;</td>
<td>Срок истечения</td>
</tr>
<tr>
<td>number</td>
<td>String</td>
<td>&quot;723902034&quot;</td>
<td>Номер</td>
</tr>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Ivanov&quot;</td>
<td>Имя</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Ivan&quot;</td>
<td>Фамилия</td>
</tr>
</tbody></table>

<h3 id='document-photo-entity-v2'> Фотография документа </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>1</td>
<td>ID фотографии</td>
</tr>
<tr>
<td>doument_id</td>
<td>Integer</td>
<td>1</td>
<td>ID документа</td>
</tr>
<tr>
<td>document_type</td>
<td>String</td>
<td>&#39;local_passport&#39;</td>
<td>Тип документа</td>
</tr>
<tr>
<td>image</td>
<td>File</td>
<td>@path/to/file/local_passport.jpg</td>
<td>Файл фотографии</td>
</tr>
</tbody></table>

<h3 id='social-profile-entity-v2'> Профиль социальной сети </h3>

<p>** В разработке **</p>

<h3 id='initial-payment-entity-v2'> Первоначальный платеж </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>1</td>
<td>ID платежа</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>1000</td>
<td>Сумма</td>
</tr>
</tbody></table>

<h3 id='credit-card-entity-v2'> Банковская карта </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>1</td>
<td>ID карты</td>
</tr>
<tr>
<td>number</td>
<td>String</td>
<td>&#39;411111******1112&#39;</td>
<td>Маскированный номер карты</td>
</tr>
<tr>
<td>expiration_date</td>
<td>String</td>
<td>&#39;12/23&#39;</td>
<td>Срок действия карты</td>
</tr>
</tbody></table>

<h3 id='decision-entity-v2'> Решение по заявке </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>1</td>
<td>ID решения</td>
</tr>
<tr>
<td>approved</td>
<td>Boolean</td>
<td>false</td>
<td>Решение по заявке</td>
</tr>
</tbody></table>

<h3 id='scheduled-payment-entity-v2'> Очередной платеж </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>1</td>
<td>ID платежа</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>1000</td>
<td>Размер платежа</td>
</tr>
<tr>
<td>state</td>
<td>String</td>
<td>&#39;awaiting_charge&#39;</td>
<td>Статус платежа</td>
</tr>
<tr>
<td>payment_date</td>
<td>Date</td>
<td>&#39;2019-06-06&#39;</td>
<td>Запланированная дата платежа</td>
</tr>
<tr>
<td>paid_at</td>
<td>Datetime</td>
<td>&#39;2019-06-08 15:00:00 +03:00&#39;</td>
<td>Фактическая дата оплаты платежа</td>
</tr>
<tr>
<td>penalty</td>
<td>Boolean</td>
<td>true</td>
<td>Флаг выхода платежа на просрочку</td>
</tr>
<tr>
<td>penalty_amount</td>
<td>Decimal</td>
<td>50</td>
<td>Размер штрафа</td>
</tr>
</tbody></table>

<h3 id='payment-attempt-entity-v2'> Попытка списания </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>scheduled_payment_id</td>
<td>Integer</td>
<td>1</td>
<td>ID платежа подлежащегь списанию</td>
</tr>
</tbody></table>

<h3 id='charged-payment-entity-v2'> Состоявшийся платеж </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>1</td>
<td>ID платежа</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>1000</td>
<td>Размер платежа</td>
</tr>
<tr>
<td>paid_at</td>
<td>Datetime</td>
<td>&#39;2019-06-08 15:00:00 +03:00&#39;</td>
<td>Фактическая дата оплаты платежа</td>
</tr>
</tbody></table>

<h3 id='refund-entity-v2'> Возврат </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>1</td>
<td>ID платежа</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>1000</td>
<td>Сумма возврата</td>
</tr>
</tbody></table>

<h3 id='product-entity-v2'> Товар </h3>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>1</td>
<td>ID продукта</td>
</tr>
<tr>
<td>product_type</td>
<td>String</td>
<td>&#39;airline_ticket&#39;</td>
<td></td>
</tr>
<tr>
<td>product_items</td>
<td>Array</td>
<td>См раздел &quot;Товар&quot;</td>
<td>Список товаров</td>
</tr>
</tbody></table>

<h3 id='additional-entities-v2'>Дополнительные сущности</h3>

<h4 id='meta-entity-v2'><code>meta</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>client_orders_count</td>
<td>Integer</td>
<td>14</td>
<td>Количество успешных заказов клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>client_login</td>
<td>Boolean</td>
<td>true/false</td>
<td>Статус клиента (залогинен или нет)</td>
<td>Нет</td>
</tr>
<tr>
<td>orders_count</td>
<td>Integer</td>
<td>3</td>
<td>Сумма заказов клиента у партнера</td>
<td>Нет</td>
</tr>
<tr>
<td>book_code</td>
<td>String</td>
<td>&quot;Y&quot;</td>
<td>Код бронирования</td>
<td>Нет</td>
</tr>
</tbody></table>

<p>Базовый URL: <code>https://dev.moneywall.io/api/v2/</code></p>

<h2 id='auth-v2'> Аутентификация </h2>

<p><strong>TBD</strong></p>

<h2 id='credit-application-v2'> Кредитная заявка </h2>

<p>Создание заявки</p>

<p><strong>HTTP Запрос</strong></p>

<p><code>POST https://dev.moneywall.io/api/v2/credit_applications</code></p>

<p><strong>Схема запроса</strong></p>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>phone</td>
<td>String</td>
<td>&quot;79588249424&quot;</td>
<td>Номер телефона клиента</td>
<td>Да</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>&quot;user@gmail.com&quot;</td>
<td>Адрес электронной почты клиента</td>
<td>Да</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>10000</td>
<td>Сумма заказа в рублях</td>
<td>Да</td>
</tr>
<tr>
<td>success_callback_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/callbacks/success&quot;</td>
<td>Адрес callback-страницы, вызываемой при одобрении заявки</td>
<td>Да</td>
</tr>
<tr>
<td>failure_callback_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/callbacks/failure&quot;</td>
<td>Адрес callback-страницы, вызываемой при отклонении заявки</td>
<td>Да</td>
</tr>
<tr>
<td>redirect_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/order/AB123-45&quot;</td>
<td>Адрес страницы заказа в системе партнера</td>
<td>Да</td>
</tr>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Идентификатор сессии со стороны партнера (по нему можно будет <a href="#payment-state">получать статус</a>)</td>
<td>Да</td>
</tr>
<tr>
<td>original_provider_order_id</td>
<td>String</td>
<td>&quot;AB123-45&quot;</td>
<td>Идентификатор заказа в системе партнера</td>
<td>Нет</td>
</tr>
<tr>
<td>expires_at</td>
<td>DateTime</td>
<td>&quot;2017-07-01T15:00:00+03:00&quot;</td>
<td>Таймлимит для заказа</td>
<td>Нет</td>
</tr>
<tr>
<td>product_type</td>
<td>String</td>
<td>&quot;airline_tickets&quot;</td>
<td>Тип товара, под который выдается кредит</td>
<td>Нет</td>
</tr>
<tr>
<td>product</td>
<td>Object</td>
<td>См. <a href="#product-schema">схему объекта product</a></td>
<td>Детали товара, под который выдается кредит</td>
<td>Да, если передан тип товара</td>
</tr>
<tr>
<td>local_passport</td>
<td>Object</td>
<td>См. <a href="#local-passport-schema">схему объекта local_passport</a></td>
<td>Общегражданский паспорт клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>address</td>
<td>Object</td>
<td>См. <a href="#address-schema">схему объекта address</a></td>
<td>Адрес регистрации клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>international_passport</td>
<td>Object</td>
<td>См. <a href="#international-passport-schema">схему объекта international_passport</a></td>
<td>Загранпаспорт клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>meta</td>
<td>Object</td>
<td>См. <a href="#meta-schema">схему объекта meta</a></td>
<td>Дополнительная информация</td>
<td>Нет</td>
</tr>
</tbody></table>

<p>Получение полной информации по заявке
<strong>HTTP Запрос</strong>
<code>GET https://dev.moneywall.io/api/v2/credit_applications/:id</code></p>

<table><thead>
<tr>
<th>Поле</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>1</td>
<td>ID заявки</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>10000</td>
<td>Сумма займа</td>
</tr>
<tr>
<td>remaining_amount</td>
<td>Decimal</td>
<td>3000</td>
<td>Оставшаяся сумма по договору к оплате</td>
</tr>
<tr>
<td>local_passport</td>
<td>LocalPassport</td>
<td>Объект сущности LocalPassport</td>
<td>Объект общегражданского паспорта</td>
</tr>
<tr>
<td>international_passport</td>
<td>InternationalPassport</td>
<td>Объект сущности InternationalPassport</td>
<td>Объект загранпаспорта</td>
</tr>
<tr>
<td>address</td>
<td>Address</td>
<td>Объект сущности Address</td>
<td>Объект адреса</td>
</tr>
<tr>
<td>document_photos</td>
<td>Array</td>
<td>Массив сущностей DocumentPhoto</td>
<td>Массив фотографий документов</td>
</tr>
<tr>
<td>product</td>
<td>Product</td>
<td>Объект сущности Product</td>
<td>Объект товара</td>
</tr>
<tr>
<td>payment_graph</td>
<td>Array</td>
<td>Массив объектов Payment</td>
<td>График платажей</td>
</tr>
</tbody></table>

<h3 id='credit-application-v2-signature'> Электронная подпись </h3>

<p><code>POST#credit_applications/:id/verification_code</code></p>

<p>Получение кода подписи по заданному каналу</p>
<h4 id='8dcef6d02c'>Код подписи</h4>
<p>Метод выполняется в контексте <a href="#credit-application-v2-signature">Электронной подписи</a></p>

<p><code>POST#credit_applications/:id/verification_code/sign</code></p>

<p>Ввод полученного кода</p>
<h3 id='9b19ad0c85'>Документы</h3>
<p><code>POST#credit_applications/:id/document</code></p>

<p>Передача данных документов с типом</p>
<h3 id='2b8df6d4ef'>Фотографии документов</h3>
<p><code>POST#credit_applications/:id/document_photo</code></p>

<p>Передача фото документов</p>
<h3 id='5e513ad59a'>Соцсети</h3>
<p><code>POST#credit_applications/:id/social_profile</code></p>

<p>???????</p>
<h3 id='348a6d9ca8'>Первоначальный платеж</h3>
<p><code>POST#credit_applications/:id/initial_payment</code></p>

<p>Попытка списания платежа с переданной карты</p>
<h3 id='d0a65eea32'>Банковская карта</h3>
<p><code>POST#credit_applications/:id/credit_payment</code></p>

<p>Создание банковской карты</p>
<h3 id='b13291dd35'>Решение по заявке</h3>
<p><code>GET#credit_applications/:id/decision</code></p>

<p>Получение решения по заявке</p>
<h3 id='28191fe3ec'>Степень заполненности заявки</h3>
<p><code>GET#credit_applications/:id/verify</code></p>

<p>Получение списка недостающих данных</p>

<h2 id='credit-agreement-v2'> Договор </h2>

<p><code>GET#credit_agreements/:id</code></p>

<p>Получение договора со всеми вложенными сущностями</p>
<h3 id='7df0bc4c57'>График платежей</h3>
<p><code>GET#credit_agreements/:id/payment_schedule</code></p>

<p>Получение актуального списка платежей</p>
<h3 id='d44e3a7b8a'>Очередной платеж</h3>
<p><code>GET#credit_agreements/:id/credit_payments/:id</code></p>

<p>Информация о платеже</p>

<p><code>POST#credit_agreements/:id/credit_payments/:id/charge</code></p>

<p>Попытка оплаты платежа</p>
<h3 id='573deecfc8'>Попытка списания</h3>
<p><code>POST#credit_agreements/:id/payments/pay</code></p>

<p>Попытка списания платежа (id, сумма, мета)</p>
<h3 id='cecde846db'>Состоявшийся платеж</h3>
<p><code>POST#credit_agreements/:id/payments/paid</code></p>

<p>Уведомление об успешно списанном платеже с информацией
            (тип платежа, id, сумма, мета)</p>
<h3 id='74a7af0529'>Возвраты</h3>
<p><code>POST#credit_agreements/:id/refund</code></p>

<p>Запрос на проведение возврата</p>

<p><code>GET#credit_agreements/:id/refunds</code></p>

<p>Получение списка возвратов</p>
<h4 id='5283e33473'>Возврат</h4>
<p><code>GET#credit_agreements/:id/refunds/:id</code></p>

<p>Получение статуса возврата</p>
<h3 id='d0a65eea32-2'>Банковская карта</h3>
<p><code>POST#credit_agreements/:id/credit_card</code></p>

<p>Поздание банковской карты (у нас привязывается к клиенту)</p>
<h3 id='d640e3383d'>Ввод договора в действие (?)</h3>
<p><code>POST#credit_agreements/:id/service_provided</code></p>

<p>Передача данных о предоставленной услуге</p>

<h2 id='cash-flow-v2'> Движения Денежных Средств </h2>

<p><code>GET#cash_flow</code></p>

<p>Получение списка платежей и возвратов по фильтру</p>
<h2 id='webhooks'>Webhooks</h2><h3 id='397cc59b74'>Принятие решения по заявке</h3><h3 id='aaef60cd3f'>Изменение графика платежей</h3>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
