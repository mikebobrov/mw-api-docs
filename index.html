
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Moneywall API | Документация</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Поиск">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#v1" class="toc-h1 toc-link" data-title=" API v1 "> API v1 </a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#introduction" class="toc-h2 toc-link" data-title="Общая информация">Общая информация</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#formula" class="toc-h3 toc-link" data-title="Формула рассчета цены">Формула рассчета цены</a>
                            </li>
                        </ul>
                  </li>
                  <li>
                    <a href="#auth" class="toc-h2 toc-link" data-title="Аутентификация">Аутентификация</a>
                  </li>
                  <li>
                    <a href="#payments" class="toc-h2 toc-link" data-title="Платежные сессии">Платежные сессии</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#payment-init" class="toc-h3 toc-link" data-title="Начало платежной сессии">Начало платежной сессии</a>
                            </li>
                            <li>
                              <a href="#product" class="toc-h3 toc-link" data-title="Добавление выписанных билетов к заказу">Добавление выписанных билетов к заказу</a>
                            </li>
                            <li>
                              <a href="#payment-state" class="toc-h3 toc-link" data-title="Статус платёжной сессии">Статус платёжной сессии</a>
                            </li>
                            <li>
                              <a href="#payment-refund" class="toc-h3 toc-link" data-title="Возврат">Возврат</a>
                            </li>
                        </ul>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#v2" class="toc-h1 toc-link" data-title=" API v2 "> API v2 </a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#auth-v2" class="toc-h2 toc-link" data-title=" Аутентификация "> Аутентификация </a>
                  </li>
                  <li>
                    <a href="#credit-application-v2" class="toc-h2 toc-link" data-title=" Кредитная заявка "> Кредитная заявка </a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#credit-application-v2-signature" class="toc-h3 toc-link" data-title=" Электронная подпись "> Электронная подпись </a>
                            </li>
                            <li>
                              <a href="#9b19ad0c85" class="toc-h3 toc-link" data-title="Документы">Документы</a>
                            </li>
                            <li>
                              <a href="#2b8df6d4ef" class="toc-h3 toc-link" data-title="Фотографии документов">Фотографии документов</a>
                            </li>
                            <li>
                              <a href="#5e513ad59a" class="toc-h3 toc-link" data-title="Соцсети">Соцсети</a>
                            </li>
                            <li>
                              <a href="#348a6d9ca8" class="toc-h3 toc-link" data-title="Первоначальный платеж">Первоначальный платеж</a>
                            </li>
                            <li>
                              <a href="#d0a65eea32" class="toc-h3 toc-link" data-title="Банковская карта">Банковская карта</a>
                            </li>
                            <li>
                              <a href="#b13291dd35" class="toc-h3 toc-link" data-title="Решение по заявке">Решение по заявке</a>
                            </li>
                            <li>
                              <a href="#28191fe3ec" class="toc-h3 toc-link" data-title="Степень заполненности заявки">Степень заполненности заявки</a>
                            </li>
                        </ul>
                  </li>
                  <li>
                    <a href="#credit-agreement-v2" class="toc-h2 toc-link" data-title=" Договор "> Договор </a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#7df0bc4c57" class="toc-h3 toc-link" data-title="График платежей">График платежей</a>
                            </li>
                            <li>
                              <a href="#d44e3a7b8a" class="toc-h3 toc-link" data-title="Очередной платеж">Очередной платеж</a>
                            </li>
                            <li>
                              <a href="#573deecfc8" class="toc-h3 toc-link" data-title="Попытка списания">Попытка списания</a>
                            </li>
                            <li>
                              <a href="#cecde846db" class="toc-h3 toc-link" data-title="Состоявшийся платеж">Состоявшийся платеж</a>
                            </li>
                            <li>
                              <a href="#74a7af0529" class="toc-h3 toc-link" data-title="Возвраты">Возвраты</a>
                            </li>
                            <li>
                              <a href="#d0a65eea32-2" class="toc-h3 toc-link" data-title="Банковская карта">Банковская карта</a>
                            </li>
                            <li>
                              <a href="#d640e3383d" class="toc-h3 toc-link" data-title="Ввод договора в действие (?)">Ввод договора в действие (?)</a>
                            </li>
                        </ul>
                  </li>
                  <li>
                    <a href="#cash-flow-v2" class="toc-h2 toc-link" data-title=" Движения Денежных Средств "> Движения Денежных Средств </a>
                  </li>
                  <li>
                    <a href="#webhooks" class="toc-h2 toc-link" data-title="Webhooks">Webhooks</a>
                        <ul class="toc-list-h3">
                            <li>
                              <a href="#397cc59b74" class="toc-h3 toc-link" data-title="Принятие решения по заявке">Принятие решения по заявке</a>
                            </li>
                            <li>
                              <a href="#aaef60cd3f" class="toc-h3 toc-link" data-title="Изменение графика платежей">Изменение графика платежей</a>
                            </li>
                        </ul>
                  </li>
              </ul>
          </li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='v1'> API v1 </h1>

<h2 id='introduction'>Общая информация</h2>

<p>Moneywall – сервис онлайн-кредитования, который встраивается на страницы оплаты партнеров и позволяет покупателям приобретать товары в кредит.</p>

<p>API работает по протоколу HTTPS, все данные представлены в формате JSON.</p>

<p>Базовый URL – <code>https://dev.moneywall.io/api/partners</code></p>

<p>Простой сценарий подачи и прохождения кредитной заявки:</p>

<ol>
<li>Вызов метода <a href="#payment-init">Начала платежной сессии</a></li>
<li>Вывод фрейма по ссылке, полученной из результата запроса</li>
<li>Ввод пользователем информации</li>
<li>Перенаправление пользователя на адресу из <code>redirect_url</code></li>
<li>Ожидание решения по заявке</li>
<li>Вызов <code>success_callback_url</code> или <code>failure_callback_url</code> при одобрении или отклонении заявки соответственно</li>
</ol>

<h3 id='formula'>Формула рассчета цены</h3>

<p>Для расчёта и отображения платежей и полной стоимости заказа на стороне партнёра, следует использовать упрощенную формулу:</p>

<p><code>ПЛАТЕЖ  = (СУММА ЗАКАЗА * K) / 3,</code></p>

<p>где <code>K = 1.10</code> для случаев, когда вылет наступает после окончания договора займа (больше, чем 64 дня от даты открытия договора),
<br>и <code>K = 1.20</code> для случаев, когда вылет наступает ранее даты окончания договора займа.</p>

<h2 id='auth'>Аутентификация</h2>

<p>Аутентификация производится через токен партнера, передаваемый в заголовке Authorization при каждом запросе:</p>

<p><code>Authorization: SuperSecretTokenValue</code></p>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/init"</span>
  -H <span class="s2">"Authorization: SuperSecretTokenValue"</span>
</code></pre>
<aside class="notice">
Пожалуйста, замените <code>SuperSecretTokenValue</code> на предоставленный вам токен
</aside>

<h2 id='payments'>Платежные сессии</h2>

<h3 id='payment-init'>Начало платежной сессии</h3>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/init"</span>
  -X POST
  -H <span class="s2">"Content-Type: application/json"</span>
  -H <span class="s2">"Authorization: SuperSecretTokenValue"</span>
  -d <span class="s1">'{ "phone": "79031232299", "email": "test@test.com", "amount": 10000, "calculated_credit_cost": 12000, "success_callback_url": "http://yoursite.com/callbacks/success", "failure_callback_url": "http://yoursite.com/callbacks/failure", "redirect_url": "http://yoursite.com/order/234", "order_id": "partner_order_id", "web_mode": "standalone", "original_provider_order_id": "original_provider_order_id", "expires_at": "2017-07-01T00:00:00", "product_type": "airline_tickets" }'</span>

</code></pre>
<blockquote>
<p>Команда выше вернет ответ в JSON следующего вида:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span><span class="w">
  </span><span class="s2">"frame_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://dev.moneywall.io/frame/credit_applications/10/payment_graph"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Метод предназначен для начала сессии выдачи кредита</p>

<p><strong>HTTP Запрос</strong></p>

<p><code>POST https://dev.moneywall.io/api/partners/payments/init</code></p>

<p><strong>Схема запроса</strong></p>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>phone</td>
<td>String</td>
<td>&quot;79588249424&quot;</td>
<td>Номер телефона клиента</td>
<td>Да</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>&quot;user@gmail.com&quot;</td>
<td>Адрес электронной почты клиента</td>
<td>Да</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>10000</td>
<td>Сумма заказа клиента на сайте партнера в рублях</td>
<td>Да</td>
</tr>
<tr>
<td>success_callback_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/callbacks/success&quot;</td>
<td>Адрес callback-страницы, вызываемой при одобрении заявки</td>
<td>Да</td>
</tr>
<tr>
<td>failure_callback_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/callbacks/failure&quot;</td>
<td>Адрес callback-страницы, вызываемой при отклонении заявки</td>
<td>Да</td>
</tr>
<tr>
<td>redirect_url</td>
<td>String</td>
<td>&quot;http://yoursite.com/order/AB123-45&quot;</td>
<td>Адрес страницы заказа в системе партнера</td>
<td>Да</td>
</tr>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Идентификатор сессии со стороны партнера (по нему можно будет <a href="#payment-state">получать статус</a>)</td>
<td>Да</td>
</tr>
<tr>
<td>web_mode</td>
<td>String: &quot;standalone&quot;, &quot;iframe&quot;</td>
<td>&quot;standalone&quot;</td>
<td>Режим, в котором будет открыт диалог заполнения кредитной заявки (по умолчанию: standalone)</td>
<td>Нет</td>
</tr>
<tr>
<td>original_provider_order_id</td>
<td>String</td>
<td>&quot;AB123-45&quot;</td>
<td>Идентификатор заказа в системе партнера</td>
<td>Нет</td>
</tr>
<tr>
<td>expires_at</td>
<td>DateTime</td>
<td>&quot;2017-07-01T15:00:00+03:00&quot;</td>
<td>Таймлимит для заказа</td>
<td>Нет</td>
</tr>
<tr>
<td>product_type</td>
<td>String</td>
<td>&quot;airline_tickets&quot;</td>
<td>Тип товара, под который выдается кредит</td>
<td>Нет</td>
</tr>
<tr>
<td>product</td>
<td>Object</td>
<td>См. <a href="#product-schema">схему объекта product</a></td>
<td>Детали товара, под который выдается кредит</td>
<td>Да, если передан тип товара</td>
</tr>
<tr>
<td>local_passport</td>
<td>Object</td>
<td>См. <a href="#local-passport-schema">схему объекта local_passport</a></td>
<td>Общегражданский паспорт клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>address</td>
<td>Object</td>
<td>См. <a href="#address-schema">схему объекта address</a></td>
<td>Адрес регистрации клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>international_passport</td>
<td>Object</td>
<td>См. <a href="#international-passport-schema">схему объекта international_passport</a></td>
<td>Загранпаспорт клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>meta</td>
<td>Object</td>
<td>См. <a href="#meta-schema">схему объекта meta</a></td>
<td>Дополнительная информация</td>
<td>Нет</td>
</tr>
</tbody></table>

<blockquote>
<p>Пожалуйста, обратите внимание, что параметры с типом DateTime следует передавать в формате ISO8601 с часовым поясом. Рекомендуемый формат даты: <code>&quot;%Y-%m-%dT%H:%M:%S%:z&quot;</code></p>
</blockquote>

<h4 id='product-schema'>Схема объекта <code>product</code> при <code>product_type == 'airline_tickets'</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>cabin_type</td>
<td>String</td>
<td>&quot;economy&quot; (&quot;business&quot;, &quot;premium&quot;)</td>
<td>Класс обслуживания</td>
<td>Да</td>
</tr>
<tr>
<td>validating_airline</td>
<td>String</td>
<td>&quot;SU&quot;</td>
<td>Валидирующая авиакомпания</td>
<td>Да</td>
</tr>
<tr>
<td>segments</td>
<td>Array</td>
<td>См. <a href="#segment-schema">схему объекта segment</a></td>
<td>Сегменты</td>
<td>Да</td>
</tr>
<tr>
<td>passengers</td>
<td>Array</td>
<td>См. <a href="#passenger">схему объекта passenger</a></td>
<td>Пассажиры</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='passenger-schema'>Схема объекта <code>passenger</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Ivan&quot;</td>
<td>Имя</td>
<td>Да</td>
</tr>
<tr>
<td>middle_name</td>
<td>String</td>
<td>&quot;Aleksandrovich&quot;</td>
<td>Отчество</td>
<td>Нет</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Ivanon&quot;</td>
<td>Фамилия</td>
<td>Да</td>
</tr>
<tr>
<td>document_type</td>
<td>String</td>
<td>&quot;international_passport&quot; (&quot;local_passport&quot;, &quot;birth_certificate&quot;)</td>
<td>Тип документа</td>
<td>Да</td>
</tr>
<tr>
<td>document_number</td>
<td>String</td>
<td>&quot;349287349&quot;</td>
<td>Номер документа</td>
<td>Да</td>
</tr>
<tr>
<td>birth_date</td>
<td>String</td>
<td>&quot;1987-07-18&quot;</td>
<td>Дата рождения</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='segment-schema'>Схема объекта <code>segment</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>flights</td>
<td>Array</td>
<td>См. <a href="#flight-schema">схему объекта flight</a></td>
<td>Перелеты</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='flight-schema'>Схема объекта <code>flight</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>aircraft</td>
<td>String</td>
<td>&quot;737&quot;</td>
<td>Модель самолета</td>
<td>Да</td>
</tr>
<tr>
<td>departure_dt</td>
<td>DateTime</td>
<td>&quot;2016-12-10T08:00:00+03:00&quot;</td>
<td>Время вылета</td>
<td>Да</td>
</tr>
<tr>
<td>arrival_dt</td>
<td>DateTime</td>
<td>&quot;2018-12-10T10:00:00+03:00&quot;</td>
<td>Время прилета</td>
<td>Да</td>
</tr>
<tr>
<td>book_code</td>
<td>String</td>
<td>&quot;Y&quot;</td>
<td>Код бронирования</td>
<td>Да</td>
</tr>
<tr>
<td>orig</td>
<td>String</td>
<td>&quot;SVO&quot;</td>
<td>Аэропорт вылета</td>
<td>Да</td>
</tr>
<tr>
<td>dest</td>
<td>String</td>
<td>&quot;VIE&quot;</td>
<td>Аэропорт прилета</td>
<td>Да</td>
</tr>
<tr>
<td>flight_number</td>
<td>String</td>
<td>&quot;606&quot;</td>
<td>Номер рейса</td>
<td>Да</td>
</tr>
<tr>
<td>marketing_ac</td>
<td>String</td>
<td>&quot;SU&quot;</td>
<td>Маркетинговый перевозчик</td>
<td>Да</td>
</tr>
<tr>
<td>operating_ac</td>
<td>String</td>
<td>&quot;SU&quot;</td>
<td>Оперирующий перевозчик</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='local-passport-schema'>Схема объекта общегражданского паспорта <code>local_passport</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>birth_date</td>
<td>Date</td>
<td>&quot;1987-07-18&quot;</td>
<td>Дата рождения</td>
<td>Да</td>
</tr>
<tr>
<td>issue_date</td>
<td>Date</td>
<td>&quot;2001-01-01&quot;</td>
<td>Дата выдачи паспорта</td>
<td>Да</td>
</tr>
<tr>
<td>number</td>
<td>String</td>
<td>&quot;4444333222&quot;</td>
<td>Серия и номер паспорта</td>
<td>Да</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Иванов&quot;</td>
<td>Фамилия</td>
<td>Да</td>
</tr>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Иван&quot;</td>
<td>Имя</td>
<td>Да</td>
</tr>
<tr>
<td>middle_name</td>
<td>String</td>
<td>&quot;Александрович&quot;</td>
<td>Отчество</td>
<td>Да</td>
</tr>
<tr>
<td>sex</td>
<td>String: &quot;female&quot;, &quot;male&quot;</td>
<td>&quot;female&quot;</td>
<td>Пол по паспорту</td>
<td>Да</td>
</tr>
<tr>
<td>issuing_authority</td>
<td>String</td>
<td>&quot;ОВД Района Калитники&quot;</td>
<td>Кем выдан</td>
<td>Да</td>
</tr>
<tr>
<td>authority_code</td>
<td>String</td>
<td>&quot;663402&quot;</td>
<td>Код подразделения</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='address-schema'>Схема объекта адреса <code>address</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>city</td>
<td>String</td>
<td>&quot;Москва&quot;</td>
<td>Город</td>
<td>Да</td>
</tr>
<tr>
<td>street</td>
<td>String</td>
<td>&quot;ул. Китобойцев&quot;</td>
<td>Улица</td>
<td>Да</td>
</tr>
<tr>
<td>building</td>
<td>String</td>
<td>&quot;3&quot;</td>
<td>Дом</td>
<td>Да</td>
</tr>
<tr>
<td>housing</td>
<td>String</td>
<td>&quot;1&quot;</td>
<td>Строение</td>
<td>Нет</td>
</tr>
<tr>
<td>apartment</td>
<td>String</td>
<td>&quot;616&quot;</td>
<td>Квартира</td>
<td>Нет</td>
</tr>
<tr>
<td>postcode</td>
<td>String</td>
<td>&quot;111123&quot;</td>
<td>Почтовый индекс</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='international-passport-schema'>Схема объекта загранпаспорта <code>international_passport</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>country_code</td>
<td>String</td>
<td>&quot;RU&quot;</td>
<td>Код страны</td>
<td>Да</td>
</tr>
<tr>
<td>birth_date</td>
<td>Date</td>
<td>&quot;1987-07-18&quot;</td>
<td>Дата рождения</td>
<td>Да</td>
</tr>
<tr>
<td>expiration_date</td>
<td>Date</td>
<td>&quot;2020-01-01&quot;</td>
<td>Срок истечения</td>
<td>Да</td>
</tr>
<tr>
<td>number</td>
<td>String</td>
<td>&quot;723902034&quot;</td>
<td>Номер</td>
<td>Да</td>
</tr>
<tr>
<td>first_name</td>
<td>String</td>
<td>&quot;Ivanov&quot;</td>
<td>Имя</td>
<td>Да</td>
</tr>
<tr>
<td>last_name</td>
<td>String</td>
<td>&quot;Ivan&quot;</td>
<td>Фамилия</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='meta-schema'>Схема объекта <code>meta</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>client_orders_count</td>
<td>Integer</td>
<td>14</td>
<td>Количество успешных заказов клиента</td>
<td>Нет</td>
</tr>
<tr>
<td>client_login</td>
<td>Boolean</td>
<td>true/false</td>
<td>Статус клиента (залогинен или нет)</td>
<td>Нет</td>
</tr>
<tr>
<td>orders_count</td>
<td>Integer</td>
<td>3</td>
<td>Сумма заказов клиента у партнера</td>
<td>Нет</td>
</tr>
<tr>
<td>book_code</td>
<td>String</td>
<td>&quot;Y&quot;</td>
<td>Код бронирования</td>
<td>Нет</td>
</tr>
<tr>
<td>original_provider_order_id</td>
<td>String</td>
<td>&quot;AB123-45&quot;</td>
<td>Идентификатор заказа в системе партнера</td>
<td>Нет</td>
</tr>
</tbody></table>

<h3 id='product'>Добавление выписанных билетов к заказу</a></h3>
<pre class="highlight shell tab-shell"><code>curl -X POST   <span class="se">\</span>
 -H <span class="s1">'Authorization: SuperSecretTokenValue'</span> <span class="se">\</span>
 -F <span class="s1">'order_id=partner_order_id'</span> <span class="se">\</span>
 -F <span class="s1">'product[product_type]=airline_tickets'</span> <span class="se">\</span>
 -F <span class="s1">'product[product_items][][ticket_number]=123'</span> <span class="se">\</span>
 -F <span class="s1">'product[product_items][][ticket_receipt]=@path/to/file/test_pdf.pdf'</span> <span class="se">\</span>
https://dev.moneywall.io/api/partners/payments/product
</code></pre>
<p>Метод предназначен для сохранения номеров билетов и файлов маршрутных квитанций в кредитной заявке
<strong>HTTP Запрос</strong></p>

<p><code>POST https://dev.moneywall.io/api/partners/payments/product</code></p>

<p><strong>URL параметры</strong></p>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Идентификатор платежной сессии, переданный в метод начала платежной сессии</td>
<td>Да</td>
</tr>
<tr>
<td>transaction_letter</td>
<td>File</td>
<td>@path/to/file/test_pdf.pdf</td>
<td>Транзакционное письмо</td>
<td>Нет</td>
</tr>
<tr>
<td>product</td>
<td>Object</td>
<td>См. <a href="#product">схему объекта product</a></td>
<td>Фактически выписанные билеты</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='product'>Схема объекта <code>product</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>product_type</td>
<td>String</td>
<td>&quot;airline-tickets&quot;</td>
<td>Тип билетов</td>
<td>Да</td>
</tr>
<tr>
<td>product_items</td>
<td>Array</td>
<td>См. <a href="#product-items">схему объекта product_items</a></td>
<td>Список билетов и маршрутных квитанций</td>
<td>Да</td>
</tr>
</tbody></table>

<h4 id='product-items'>Схема объекта <code>product_items</code></h4>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>ticket_number</td>
<td>String</td>
<td>&quot;421-288879826&quot;</td>
<td>Номер билета</td>
<td>Да</td>
</tr>
<tr>
<td>ticket_receipt</td>
<td>File</td>
<td>@path/to/file/test_pdf.pdf</td>
<td>Файл маршрутной квитанции (pdf, doc, docx). Не больше 8MB</td>
<td>Да</td>
</tr>
</tbody></table>

<h3 id='payment-state'>Статус платёжной сессии</a></h3>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/state?order_id=partner_order_id"</span>
  -H <span class="s2">"Authorization: SuperSecretTokenValue"</span>
</code></pre>
<blockquote>
<p>Команда выше вернет ответ в JSON следующего вида:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"order_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"partner_order_id"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"processing"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Метод предназначен для получения статуса платежной сессии</p>

<aside class="notice">Метод возвращает статус кредитной заявки в системе Moneywall</aside>

<p><strong>HTTP Запрос</strong></p>

<p><code>GET https://dev.moneywall.io/api/partners/payments/state</code></p>

<p><strong>URL параметры</strong></p>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Идентификатор платежной сессии, переданный в метод начала платежной сессии</td>
<td>Да</td>
</tr>
</tbody></table>

<p><strong>Возможные статусы</strong></p>

<p>Описание логики отмены и закрытия договора при возвратах см. в <a href="#payment-refund">разделе Возврат</a></p>

<table><thead>
<tr>
<th>Код&nbsp;статуса</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>processing</td>
<td>Платеж обрабатывается</td>
</tr>
<tr>
<td>cancelled</td>
<td>Платежная сессия отменена</td>
</tr>
<tr>
<td>authorized</td>
<td>Первоначальный платеж оплачен, кредитный договор открыт</td>
</tr>
<tr>
<td>voided</td>
<td>Деньги за первоначальный платеж возвращены клиенту, кредитный договор отменен</td>
</tr>
<tr>
<td>refunded</td>
<td>Произведен полный возврат по кредитному договору</td>
</tr>
<tr>
<td>charged</td>
<td>Денежные средства за первоначальный платеж списаны, возврат по договору возможен только через досрочное погашение и закрытие договора</td>
</tr>
</tbody></table>

<h3 id='payment-refund'>Возврат</h3>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://dev.moneywall.io/api/partners/payments/refund"</span>
  -X POST
  -H <span class="s2">"Content-Type: application/json"</span>
  -H <span class="s2">"Authorization: SuperSecretTokenValue"</span>
  -d <span class="s1">'{ "amount": 100, "order_id": "partner_order_id" }'</span>

</code></pre>
<blockquote>
<p>Команда выше вернет следущий ответ:</p>
</blockquote>
<pre class="highlight plaintext"><code>HTTP статус `200`, в случае если запрос обработан. Любой другой статус говорит о том, что запрос обработан не был.
</code></pre>
<p>Метод предназначен для проведение частичного или полного возврата средств по заказу</p>

<p>Частичные возвраты влекут за собой учет средств в пользу задолженности по договору.
Полные возвраты влекут за собой закрытие кредитного договора.</p>

<p><strong>Логика переходов между статусами договора</strong></p>

<p>Договор считается окончательно открытым и подтвержденным через 24 часа после момента его первоначального открытия.<br/>
До 24 часов с момента первоначального открытия договора, его можно отменить.</p>

<p>Соответственно:</p>

<ul>
<li>При полном возврате денежных средств по договору в течение 24 часов после открытия договора, происходит отмена договора и возврат денег на карту клиента путем войдирования платежной сессии;</li>
<li>При полном возврате денежных средств по договору позднее 24 часов после открытия договора, оплата идет в счет погашения.</li>
</ul>

<p><strong>HTTP Запрос</strong></p>

<p><code>POST https://dev.moneywall.io/api/partners/payments/refund</code></p>

<p><strong>URL параметры</strong></p>

<table><thead>
<tr>
<th>Параметр</th>
<th>Тип</th>
<th>Пример</th>
<th>Описание</th>
<th>Обязательно</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>String</td>
<td>&quot;vpih-234lgh&quot;</td>
<td>Идентификатор платежной сессии, переданный в метод <a href="#payment-init">начала платежной сессии</a></td>
<td>Да</td>
</tr>
<tr>
<td>amount</td>
<td>Decimal</td>
<td>100</td>
<td>Сумма возврата в рублях</td>
<td>Да</td>
</tr>
</tbody></table>

<h1 id='v2'> API v2 </h1>

<p>Ниже представлен проект документации по новой версии API</p>

<h2 id='auth-v2'> Аутентификация </h2>

<p><strong>TBD</strong></p>

<h2 id='credit-application-v2'> Кредитная заявка </h2>

<p><strong>Метод POST:</strong> Создание заявки
  <strong>Метод: GET:</strong> Получение полной информации по заявке</p>

<h3 id='credit-application-v2-signature'> Электронная подпись </h3>

<p><strong>Метод POST:</strong> Получение кода подписи по заданному каналу</p>
<h4 id='8dcef6d02c'>Код подписи</h4>
<p>Метод выполняется в контексте <a href="#credit-application-v2-signature">Электронной подписи</a>
  <strong>Метод POST:</strong> Ввод полученного кода</p>
<h3 id='9b19ad0c85'>Документы</h3>
<p><strong>Метод POST:</strong> передача данных документов с типом</p>
<h3 id='2b8df6d4ef'>Фотографии документов</h3>
<p><strong>Метод POST:</strong> передача фото документов</p>
<h3 id='5e513ad59a'>Соцсети</h3>
<p><strong>Метод POST:</strong> ???????</p>
<h3 id='348a6d9ca8'>Первоначальный платеж</h3>
<p><strong>Метод POST:</strong> попытка списания платежа с переданной карты</p>
<h3 id='d0a65eea32'>Банковская карта</h3>
<p><strong>Метод POST:</strong> создание банковской карты (у нас привязывается к клиенту)</p>
<h3 id='b13291dd35'>Решение по заявке</h3>
<p><strong>Метод GET:</strong> получение решения по заявке</p>
<h3 id='28191fe3ec'>Степень заполненности заявки</h3>
<p><strong>Метод GET:</strong> получить список недостающих данные</p>

<h2 id='credit-agreement-v2'> Договор </h2>

<p><strong>Метод GET:</strong> получение договора со всеми вложенными сущностями</p>
<h3 id='7df0bc4c57'>График платежей</h3>
<p><strong>Метод GET:</strong> получение актуального списка платежей</p>
<h3 id='d44e3a7b8a'>Очередной платеж</h3>
<p><strong>Метод GET:</strong> информация о платеже
  <strong>Метод POST:</strong> попытка оплаты платежа</p>
<h3 id='573deecfc8'>Попытка списания</h3>
<p><strong>Метод POST:</strong> попытка списания платежа
            (id, сумма, мета)</p>
<h3 id='cecde846db'>Состоявшийся платеж</h3>
<p><strong>Метод POST:</strong> уведомление об успешно списанном платеже с информацией
            (тип платежа, id, сумма, мета)</p>
<h3 id='74a7af0529'>Возвраты</h3>
<p><strong>Метод POST:</strong> запрос на проведение возврата
  <strong>Метод GET:</strong> получение списка возвратов</p>
<h4 id='5283e33473'>Возврат</h4>
<p><strong>Метод GET:</strong> получение статуса возврата</p>
<h3 id='d0a65eea32-2'>Банковская карта</h3>
<p><strong>Метод POST:</strong> создание банковской карты (у нас привязывается к клиенту)</p>
<h3 id='d640e3383d'>Ввод договора в действие (?)</h3>
<p><strong>Метод POST:</strong> передача данных о предоставленной услуге</p>

<h2 id='cash-flow-v2'> Движения Денежных Средств </h2>

<p><strong>Метод GET:</strong> получение списка платежей и возвратов по фильтру</p>
<h2 id='webhooks'>Webhooks</h2><h3 id='397cc59b74'>Принятие решения по заявке</h3><h3 id='aaef60cd3f'>Изменение графика платежей</h3>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
